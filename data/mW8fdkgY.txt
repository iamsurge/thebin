#!/bin/bash
Scheme() {
    task=$(echo $1)
    scheme=$(echo $1 | grep --only-matching -E "https?://")
    if [[ ! -z $scheme ]]; then
        echo "Scheme:" $scheme
        if [[ $scheme == "http://" ]]; then
            task=$(echo $task | sed "s/^.\{7\}//" )
        else
            task=$(echo $task | sed "s/^.\{8\}//" )
        fi  
    fi
    host=$(echo $task | sed "s/\([^:\/]*\)\(.*\)/\1/" )
    task=$(echo $task | sed "s/\([^:\/]*\)\(.*\)/\2/" )
    echo "Host:" $host
    if [[ ! -z $task ]]; then
        #:
        if [[ ":" == $(echo $task | sed "s/\(.\).*/\1/" ) ]]; then
            echo "Port: $(echo $task | sed "s/:\([^\/]*\).*/\1/")"
            task=$(echo $task | sed "s/:\([^\/]*\)\(.*\)/\2/")
        fi
        #/
        if [[ ! -z $task ]]; then
            if [[ "/" == $(echo $task | sed "s/\(.\).*/\1/" ) ]]; then
                task=$(echo $task | sed "s/\/\(.*\)/\1/")
            fi
        fi
        #args
        if [[ ! -z $task ]]; then
            if [[ "?" == $(echo $task | sed "s/\(.\).*/\1/" ) ]]; then
                task=$(echo $task | sed "s/?\(.*\)/\1/")
            fi
            if [[ ! -z $task ]]; then
                echo Args:
                while [[ ! -z $task ]]; do
                    a=$(echo $task | sed "s/\([^=]*\).*/\1/")
                    task=$(echo $task | sed "s/\([^=]*\)=\(.*\)/\2/")
                    b=$(echo $task | sed "s/\([^&]*\).*/\1/")
                    if [[ $task != $b ]]; then
                        task=$(echo $task | sed "s/\([^&]\)&\(.*\)/\2/")
                    else
                        task=""
                    fi
                    echo "  Key: $a; Value: $b"
                done
            fi
        fi
        # echo "--------------------------"
    fi
    
}

echo "" >> input.txt

while read line; do
    if [[ ! -z $line ]]; then
        line=$(echo $line | sed "s/google/yandex/g")
        Scheme $line
        echo ""
    fi
done < input.txt > output.txt