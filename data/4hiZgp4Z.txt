[[ EERST BUITEN LOOP ]]

## Verduurzaming
duurzaamheid_matrix <- read_xlsx('verduurzaming.xlsx', sheet='kosten_per_m2')
label_nums <- read_xlsx('verduurzaming.xlsx', sheet='label_num')
label_target <- 'D'
jaar_verduurzaming <- 2025


verduurzaming_starttarief <- as.numeric(cost_matrix[11, 'A++'])

verduurzamen <- function(m2, energy.label){
    oud_label <- substring(energy.label, 5)
    num_oud_label <- as.numeric(label_nums[label_nums['label'] == oud_label, 'value'])
    num_target_label <- as.numeric(label_nums[label_nums['label'] == label_target, 'value'])
    kosten_per_m2 <- as.numeric(duurzaamheid_matrix [num_oud_label, num_target_label])
    totale_kosten <- kosten_per_m2 * m2
    return(totale_kosten)
}



[[ DAARNA BINNEN LOOP ]]

#### Verduurzamingskosten om aan de target te voldoen.
## Investering vindt plaats in één jaar, en de target staat nu op 'D' (zie bovenstaande parameters).
## Kosten voor verbouwing groeien mee met CPI.
df_list[[h]] %>%
    mutate(kosten_verduurzaming = case_when(year == jaar_verduurzaming ~ verduurzamen(m2, energy.label)*df_list[[h]]$cumcpi, TRUE ~ 0)) -> df_list[[h]]
