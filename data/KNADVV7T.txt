<html>
	<head>
		<title>HTML5 canvas vertical image transition</title>
	</head>
	<body>
		<canvas id="myCanvas" width="512" height="512"></canvas>
		<style>
			canvas {
				display: block;
				margin-left: auto;
				margin-right: auto;
			}
		</style>
		<script>
			/*
			Code based on https://slicker.me/javascript/image_transition_effect.htm
			A fun test can be made with images from https://github.com/zhengyima/DeepNude_NoWatermark_withModel or https://github.com/stacklikemind/deepnude_official
			*/
			
			// https://www.quora.com/Is-%E2%80%98let%E2%80%99-or-%E2%80%98var%E2%80%99-more-appropriate-for-declaring-variables-in-JavaScript/answer/Glenn-Anderson?ch=10&oid=146277096&share=3e76ca68&target_type=answer
			var imageInit = new Image();
			imageInit.src = "input.png";

			var image = new Image();
			image.src = "output.png";
			var canvas = document.getElementById("myCanvas");
			var context = canvas.getContext("2d");
			var row, imageWidth, imageHeight;

			context.drawImage(imageInit, 0, 0);
			 
			image.onload = function() {
			  imageWidth = image.width;
			  imageHeight = image.height;
			  row = 0;
			};
			
			document.addEventListener("click", function() {
				animate();
			});

			var img = image;

			function animate() {
			  context.drawImage(img, 0, row, imageWidth, row, 0, row, imageWidth, row);
			  if (row < imageHeight) {
				  ++row;
				  requestAnimationFrame(animate);
			  }
			  else {
				row = 0;
				if (img.src == image.src) {
					img = imageInit;
				}
				else {
					img = image;
				}
			  }
			}
		</script>
	</body>
</html>
