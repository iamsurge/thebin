# Секция с общими параметрами кластера (ClusterConfiguration).
# Используемая версия API Deckhouse Platform.
apiVersion: deckhouse.io/v1
# Тип секции конфигурации.
kind: ClusterConfiguration
# Тип инфраструктуры: bare metal (Static) или облако (Cloud).
clusterType: Static
# Адресное пространство Pod’ов кластера.
podSubnetCIDR: 192.168.0.0/16
# Адресное пространство для service’ов кластера.
serviceSubnetCIDR: 10.96.0.0/16
# Устанавливаемая версия Kubernetes.
kubernetesVersion: "1.24"
# Домен кластера.
clusterDomain: "cluster.local"
---
# Секция первичной инициализации кластера Deckhouse (InitConfiguration).
# Используемая версия API Deckhouse.
apiVersion: deckhouse.io/v1
# Тип секции конфигурации.
kind: InitConfiguration
# Секция с параметрами Deckhouse.
deckhouse:
  # Используемый канал обновлений.
  bundle: Minimal
  releaseChannel: Stable
  configOverrides:
    global:
      modules:
        # Шаблон, который будет использоваться для составления адресов системных приложений в кластере.
        # Например, Grafana для %s.lk-dev.ahml.test будет доступна на домене grafana.lk-dev.ahml.test.
        publicDomainTemplate: "%s.cpicb.ahml.test"
    cniCiliumEnabled: true
    controlPlaneManagerEnabled: true
    certManagerEnabled: true
    # extendedMonitoringEnabled: true
    # helmEnabled: true
    # prometheusEnabled: true
    # prometheusMetricsAdapterEnabled: true
    # terraformManagerEnabled: true
    ingressNginxEnabled: true
    kubeDnsEnabled: true
    kubeProxyEnabled: true
    namespaceConfiguratorEnabled: true
    nodeManagerEnabled: true
    operatorPrometheusCrdEnabled: true
    operatorPrometheusEnabled: true
    podReloaderEnabled: true
    priorityClassEnabled: true
    prometheusCrdEnabled: true
    secretCopierEnabled: true
    # Настройки модуля cni-flannel.
  # Адрес Docker registry с образами Deckhouse.
  imagesRepo: nexus.ahml.ru:5010/deckhouse/ce
  # Строка с ключом для доступа к Docker registry.
  registryDockerCfg: 
  # Протокол доступа к registry (HTTP или HTTPS).
  registryScheme: HTTP
---
# Секция с параметрами bare metal кластера (StaticClusterConfiguration).
# Используемая версия API Deckhouse.
apiVersion: deckhouse.io/v1
# Тип секции конфигурации.
kind: StaticClusterConfiguration
# Список внутренних сетей узлов кластера (например, '10.0.4.0/24'), который
# используется для связи компонентов Kubernetes (kube-apiserver, kubelet...) между собой.
internalNetworkCIDRs:
- 10.208.14.0/24
- 10.209.14.0/24
- 10.80.142.0/24
