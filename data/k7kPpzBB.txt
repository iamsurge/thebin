
                                                        # RESAMPLE DATI #   
                                                     # AUTORE GIACOMO CALCA #
                                                       
    # IL FILE DA EFFETTUARE IL RESAMPLE SI DEVE TROVARE NELLA CARTELLA VENV E' DEVE ESSERE 1 SOLO PER NON FARE CONFUSIONE
    # IL NUOVO FILE RESEMPLATO VERRA' CREATO NELLA STESSA CARTELLA VENV
    
    # QUANDO SI CARICANO I DATI SU TRADESTATION L'ORARIO DELLA SESSION DA IMPOSTARE COME INIZIO E FINE PUO' FAR RITORNARE DEGLI ORARI SULLE
    # CANDELE DIVERSI DA TRADINGVIEW, QUINDI TROVARE LA CORRETTA SESSIONE DI INIIO E FINE ES: 23:00 TO 23:00 OPPURE 00:00 TO 00:00
    # E VERIFICARE POI SE I GLI INDICATORI SULLE SESSIONI DI TRADESTATION COMBACIANO CON QUELLE DI TRADINGVIEW.
    # DI SOLITO STO' CARICANDO SESSIONI SU TRADESTATION DA 23:00 TO 23:00 E CON GLI INDICATORI DI SESSIONE PTN NON HO AVUTO PROBLEMI.




import pandas as pd
import glob
import matplotlib.pyplot as plt


def resampler():
    '''
    Il programma converte tutti i file a 15 minuti
    che stanno nella sua stessa cartella in 45 minuti
    creandone una copia gia rinominata correttamente
    '''
    files = glob.glob('*15m.csv')                          # CAMBIA I MINUTI DELLA FONDTE DEL DATAFEED !!!
    for file in files:
        df1 = pd.read_csv(file)
        df = pd.read_csv(file)

        df['time'] = pd.to_datetime(df['time'] + ' ' + df['date'])
        df.set_index('time', inplace=True)
        df['volume'] = df['volume'].resample('45T').sum()   # CAMBIA I MINUTI DEL RESAMPLE CHE TI INTERESSA !!!
        df['low'] = df['low'].resample('45T').min()         # CAMBIA I MINUTI DEL RESAMPLE CHE TI INTERESSA !!!
        df['high'] = df['high'].resample('45T').max()       # CAMBIA I MINUTI DEL RESAMPLE CHE TI INTERESSA !!!
        df['open'] = df['open'].resample('45T').first()     # CAMBIA I MINUTI DEL RESAMPLE CHE TI INTERESSA !!!
        df['close'] = df['close'].resample('45T').last()    # CAMBIA I MINUTI DEL RESAMPLE CHE TI INTERESSA !!!
        df = df.reset_index()
        df.set_index('date', inplace=True)
        df['time'] = df['time'].dt.strftime('%H:%M:%S')
        df.dropna(inplace=True)
        name = file[0:-7] + '45m.csv'                       # CAMBIA IL NOME DEL RESMPLE CHE TI INTERESSA !!!
        df.to_csv(name, header=True)


resampler()




                            # ESEMPIO RESAMPLE FONTE DATAFEED 5 MINUTI SU RESAMPLE DI 60 MINUTI
                            
"""
import pandas as pd
import glob
import matplotlib.pyplot as plt


def resampler():
    '''
    Il programma converte tutti i file a 15 minuti
    che stanno nella sua stessa cartella in 45 minuti
    creandone una copia gia rinominata correttamente
    '''
    files = glob.glob('*5m.csv')                          # CAMBIA I MINUTI DELLA FONDTE DEL DATAFEED !!!
    for file in files:
        df1 = pd.read_csv(file)
        df = pd.read_csv(file)

        df['time'] = pd.to_datetime(df['time'] + ' ' + df['date'])
        df.set_index('time', inplace=True)
        df['volume'] = df['volume'].resample('60T').sum()   # CAMBIA I MINUTI DEL RESAMPLE CHE TI INTERESSA !!!
        df['low'] = df['low'].resample('60T').min()         # CAMBIA I MINUTI DEL RESAMPLE CHE TI INTERESSA !!!
        df['high'] = df['high'].resample('60T').max()       # CAMBIA I MINUTI DEL RESAMPLE CHE TI INTERESSA !!!
        df['open'] = df['open'].resample('60T').first()     # CAMBIA I MINUTI DEL RESAMPLE CHE TI INTERESSA !!!
        df['close'] = df['close'].resample('60T').last()    # CAMBIA I MINUTI DEL RESAMPLE CHE TI INTERESSA !!!
        df = df.reset_index()
        df.set_index('date', inplace=True)
        df['time'] = df['time'].dt.strftime('%H:%M:%S')
        df.dropna(inplace=True)
        name = file[0:-7] + '60m.csv'                       # CAMBIA IL NOME DEL RESMPLE CHE TI INTERESSA !!!
        df.to_csv(name, header=True)


resampler()
"""