local plr = game.Players.LocalPlayer
local plrGui = plr:WaitForChild("PlayerGui")

local statusLabel = plrGui:WaitForChild("StatusGui"):WaitForChild("StatusLabel")

local rs = game.ReplicatedStorage:WaitForChild("MurderMysteryReplicatedStorage")
local re = rs:WaitForChild("RemoteEvent")
local status = rs:WaitForChild("STATUS")


function updateStatus()
	statusLabel.Text = status.Value
end
updateStatus()

local updateStatusConnection = status:GetPropertyChangedSignal("Value"):Connect(updateStatus)


re.OnClientEvent:Connect(function(instruction, value1, value2, value3)
	
	if instruction == "DATA FAILED TO LOAD" then
		updateStatusConnection:Disconnect()
		
		statusLabel.Text = "Your data failed to load. Any progress from this session will be lost once you rejoin."
		statusLabel.TextColor3 = Color3.fromRGB(255, 199, 56)
		
	elseif instruction == "ROLE CHOSEN" then
		statusLabel.Text = "Your role is " .. value1
		
		
	elseif instruction == "DUMMY KNIFE" then
		
		local knifeClone = value1:Clone()
		knifeClone.Transparency = 0
		
		knifeClone.Velocity = value3 * 500

		knifeClone.Parent = workspace

		knifeClone.CFrame = CFrame.new(value1.Position, value3 * 1000)

		local bav = Instance.new("BodyAngularVelocity")
		bav.MaxTorque = Vector3.new(math.huge, math.huge, math.huge)

		bav.AngularVelocity = knifeClone.CFrame:VectorToWorldSpace(Vector3.new(-400, 0, 0))
		bav.Parent = knifeClone
		
		if value2 then
			value2.Destroying:Connect(function()
				knifeClone:Destroy()
			end)
		else
			knifeClone:Destroy()
		end
	end
end)