; нажималка на 123 при старте total commander
#RequireAdmin

;~ Run("C:\Program Files\totalcmd\TOTALCMD.EXE", "", @SW_SHOWMAXIMIZED)

local $Wclass = "[CLASS:TNASTYNAGSCREEN]"

local $hWnd = WinWait($Wclass, "", 30)
$hWnd = WinWait($Wclass, "", 3)
If not WinExists($Wclass) Then
   Exit
EndIf

$hWnd = WinGetHandle($Wclass)
WinActivate($hWnd)
while not WinActive($Wclass)
   Sleep(10)
WEnd

while True
   local $code = StringSplit(WinGetText($hWnd), @CRLF)[4]
   if $code=1 or $code=2 or $code=3 Then
	  ExitLoop
   EndIf
   Sleep(10)
WEnd
;~ ConsoleWrite("code: "&$code)
if $code = 3 Then
   $code = 1
ElseIf $code = 1 Then
   $code = 3
EndIf

while not WinActive($Wclass)
   Sleep(10)
WEnd
while not ControlClick($hWnd, "", "[CLASS:TButton; INSTANCE:"&$code&"]")
   Sleep(10)
WEnd

func dbg($str)
   ConsoleWrite($str&@CRLF)
EndFunc

