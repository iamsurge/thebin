#include <stdio.h>
#include <stdlib.h>

#define LUNGIME_MAXIMA 1000
int main(void) {
   FILE *ptr_fisier;
   // !!!! ATENTIE !!!! La voi s-ar putea sa fie alta cale !!!
   ptr_fisier = fopen("src/in.txt", "r");
   if(ptr_fisier == NULL){
	   printf("Nu pot deschide fisierul de intrare\n");
	   return -1;
   }
   // !!!! ATENTIE !!!! La voi s-ar putea sa fie alta cale !!!
   FILE *ptr_out = fopen("src/out.txt", "w");
   if(ptr_out == NULL){
	   printf("Nu pot deschide fisierul de iesire\n");
	   return -1;
   }
   char temporar[LUNGIME_MAXIMA];
   int un_intreg;
   int rezultat_sscanf;
   int nr_caractere_citite;
   char *buffer = (char*)malloc(sizeof(char) * LUNGIME_MAXIMA);
   int nr_total_linii = 0;
   while(fgets(buffer, LUNGIME_MAXIMA, ptr_fisier) != NULL){
	   int lungime_citita = strlen(buffer);
	   fprintf(ptr_out, "S-a citit sirul:|%s| de lungime %d\n", buffer, lungime_citita);
	   // sscanf si %s nu este recomandat dar nu e o gaura de securitate cat timp exista suficient spatiu
	   // pentru stocare (in cazul nostru, temporar este cel putin la fel de mare ca buffer)
	   rezultat_sscanf = sscanf(buffer, "%s %d%n", temporar, &un_intreg, &nr_caractere_citite);
	   if (rezultat_sscanf >= 2){
		   //S-au parsat corect cel putin 2 specificatori de format din instructiunea sscanf.
		   fprintf(ptr_out, "Am citit cuvant |%s| si intreg %d. Total %d caractere\n",
				   temporar, un_intreg, nr_caractere_citite);
	   }else{
		   fprintf(ptr_out, "Eroare parsare sscanf\n");
	   }

	   nr_total_linii++;
   }
   fprintf(ptr_out, "\nNr total linii citite: %d", nr_total_linii);
   free(buffer);
   fclose(ptr_fisier);
   return 0;
}

/****** Fisier in.txt *************
Linia_mai_lunga 10
sscanf_se_opreste_la_spatiu 200
De_aceea_trebuie_underscore_aici 3000


fgets citeste fara probleme pana la capatul liniei 4000
*/

/****** Ce veti gasi in out.txt *************
S-a citit sirul:|Linia_mai_lunga 10
| de lungime 19
Am citit cuvant |Linia_mai_lunga| si intreg 10. Total 18 caractere
S-a citit sirul:|sscanf_se_opreste_la_spatiu 200
| de lungime 32
Am citit cuvant |sscanf_se_opreste_la_spatiu| si intreg 200. Total 31 caractere
S-a citit sirul:|De_aceea_trebuie_underscore_aici 3000
| de lungime 38
Am citit cuvant |De_aceea_trebuie_underscore_aici| si intreg 3000. Total 37 caractere
S-a citit sirul:|
| de lungime 1
Eroare parsare sscanf
S-a citit sirul:|
| de lungime 1
Eroare parsare sscanf
S-a citit sirul:|fgets citeste fara probleme pana la capatul liniei 4000| de lungime 55
Eroare parsare sscanf

Nr total linii citite: 6
*/



