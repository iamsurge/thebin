# membuat model sine yang berbasis nn dan konversi ke C array
# mesti pakai everyml
import math
import numpy as np
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
# generate data antara 0 sd 2pi sebanyak 1000 data
X=np.random.uniform(low=0, high=2*math.pi, size=1000)
y=np.sin(X)

model=Sequential()
model.add(Dense(16, activation='relu',input_dim=1))
model.add(Dense(16, activation='relu'))
# bila tidak dituliskan activationny linear
model.add(Dense(1))

model.compile(optimizer='adam',loss='mse', metrics=['mse'])
model.fit(X,y,epochs=100, batch_size=16)
print (model.summary())

from everywhereml.code_generators.tensorflow import tf_porter
cpp_code = tf_porter(model, X,y).to_cpp(instance_name='sineNN')
print(cpp_code)
file = open ('sineNN.h',"w+")
content= str(cpp_code)
file.write(content)
file.close


