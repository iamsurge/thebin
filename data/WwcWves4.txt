--TASK 1
with test as (
SELECT 
concat(EXTRACT(YEAR FROM sale_date), "-", EXTRACT(MONTH FROM sale_date)) as date
, license_name
, count(license_id) as subscriptions
FROM `test-project-369620.voyagu.subscriptions`
where operation_type = 'purchase'
group by 
concat(EXTRACT(YEAR FROM sale_date), "-", EXTRACT(MONTH FROM sale_date)) 
, license_name
)
select * 
, sum(subscriptions) over(partition by license_name order by date rows between unbounded preceding and current row) as subscription_summary
from test
order by 
date
, license_name

--TASK 2
