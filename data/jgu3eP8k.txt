local MANA_CH = 1

function getPool()
  local left = redstone.getAnalogInput("left")
  if left ~= 0 then
    return left
  end
  local right = redstone.getAnalogInput("right")
  if right ~= 0 then
    return right
  end
  local front = redstone.getAnalogInput("front")
  if front ~= 0 then
    return front
  end
  local back = redstone.getAnalogInput("back")
  if back ~= 0 then
    return back
  end
  return 0
end

function getStatus()
  local status = {}
  status["name"] = os.getComputerLabel()
  status["level"] = getPool()
  return status
end

function sendStatus()
  rednet.send(MANA_CH, getStatus())
end

if not rednet.isOpen() then
  peripheral.find("modem", rednet.open)
end

sendStatus()
while true do
  os.pullEvent("redstone")
  sendStatus()
end
