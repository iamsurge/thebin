var busbars = new List<BusbarSection>();
var transformers = new List<PowerTransformer>();
var breakers = new List<Breaker>();
var lines = new List<Line>();

var roleCategoryVed = ModelImage.GetObject<RoleCategory>(Guid.Parse("10000D5A-0000-0000-C000-0000006D746C"));

foreach (var certainRole in roleCategoryVed.CategoryOrganisationRoles)
{
	foreach(var modelObjects in certainRole.Objects)
	{
		if (modelObjects is BusbarSection)
		{
			busbars.Add((BusbarSection)modelObjects);
		}
		
		if (modelObjects is PowerTransformer)
		{
			transformers.Add((PowerTransformer)modelObjects);
		}
		
		if (modelObjects is Breaker)
		{
			breakers.Add((Breaker)modelObjects);
		}
		
		if (modelObjects is Line)
		{
			lines.Add((Line)modelObjects);
		}
	}
}

var roleCategoryUpr = ModelImage.GetObject<RoleCategory>(Guid.Parse("10000D60-0000-0000-C000-0000006D746C"));

foreach (var certainRole in roleCategoryVed.CategoryOrganisationRoles)
{
	foreach(var modelObjects in certainRole.Objects)
	{
		if (modelObjects is BusbarSection)
		{
			busbars.Add((BusbarSection)modelObjects);
		}
		
		if (modelObjects is PowerTransformer)
		{
			transformers.Add((PowerTransformer)modelObjects);
		}
		
		if (modelObjects is Breaker)
		{
			breakers.Add((Breaker)modelObjects);
		}
		
		if (modelObjects is Line)
		{
			lines.Add((Line)modelObjects);
		}
	}
}

var busbarsDistinct = busbars.Distinct().Count().ToString();
var transformersDistinct = transformers.Distinct().Count().ToString();
var breakersDistinct = breakers.Distinct().Count().ToString();
var linesDistinct = lines.Distinct().Count().ToString();

MessageBox.Show($"Breakers: {breakersDistinct}\nLine: {linesDistinct}\nBusbarSection: {busbarsDistinct}\nPowerTransformer: {transformersDistinct}");
