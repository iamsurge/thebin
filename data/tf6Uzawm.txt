from kivy.core.audio import SoundLoader
from kivy.app import App
from kivy.lang import Builder
from kivy.uix.togglebutton import ToggleButton

kv = """
BoxLayout:
    orientation: 'vertical'
    Label:
        text: 'Sound Test'
        size_hint_y: None
        height: 30
    AnchorLayout:
        SoundButton:
            text: {'normal': 'Play Sound', 'down': 'Stop'}[self.state]
            size_hint: None, None
            size: 200, 48

"""


class SoundButton(ToggleButton):
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        self.sound = SoundLoader.load('Ring05.wav')   # used ot hold the sound object
        self.sound.bind(on_stop=self.on_stop)

    def on_state(self, obj, state):
        if state == 'down':
            self.sound.play()
        else:
            self.sound.stop()

    def on_stop(self, _):
        self.state = 'normal'


class SoundExample(App):
    def build(self):
        return Builder.load_string(kv)


SoundExample().run()
