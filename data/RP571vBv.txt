

::: RC2
:start
@echo off
set /a netw=0
set sl=         /*\/*\/*\/*\/*\/*\/*\/*\/*\/*\/*\/*\/*\/*\
set l1=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=
set l2=\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/

::::::::::::::::::::::::::::::::::::::::::::::::
set appname=Outlook Handler Ultra Deluxe Pro
:::::::::::::::::::::::::::::::::::v::::::::::::
::set vers=7.9.8.80 20221115064157 by -JpE-
:::::::::::::::::::::::::::::::::::v::::::::::::
title %appname%
echo .
echo %sl%
echo               %appname%
echo %sl%
echo            **** %vers%
echo %sl%
echo .
echo %l1%


:outlook
set source="C:\Users\%ruser%\AppData\Local\Microsoft\Outlook"
set destin="D:\Copies\My Outlook"
:: 
set daddio="\\Daddio-PC\Users\Admin\AppData\Local\Microsoft\Outlook"
set guruji="\\GURUJIMON-PC\Users\Gurujimon\AppData\Local\Microsoft\Outlook"
:: 
set backup1="I:\Copies\My OutLook"
set backup2="X:\%ruser%-PC\My Outlook"
set backup3="H:\Aspire\OutLook"
:: 
echo .
if exist %source% echo Source NOW  Online! (C:)
if exist %destin% echo Destination Online! (D:)
if exist %daddio% echo DaddioPC is Online! (C:)
if exist %guruji% echo WOW! Even Gurujimon is On-Line!
echo .
rem bug was probably ^ the extra space I had before these echo statements to line them up with the below for an appearance scale visual. So, if it fixed this what done it. v7.9.8.80 20221115



:: New code intermixed: The "ex" mods.
set /a ex=0
if exist %backup1% set /a ex+=1
if exist %backup1% echo Backup1  is Online! (I:)
if exist %backup2% set /a ex+=1
if exist %backup2% echo Seagate7 is Online! (X:)
if exist %backup3% set /a ex+=1
if exist %backup3% echo Seagate1 is online! (H:)

if %ex% gtr 0 echo .
if %ex% gtr 0 echo *** %ex% external drives available. ***
if %ex% gtr 0 echo .



:ol1
set /a e=0
if not exist %source% set /a e=1
if not exist %source% goto err2
if not exist %destin% set /a e=2
if not exist %destin% goto ol2
echo %l2%
echo        ***** Now Syncing your Outlook Calendar  *****
echo %l2%
time /t
:: 
echo .
if %clroutdest% gtr 0 del /f /s /q %destin%"\"*.*
xcopy %source%"\"*.* %destin% /D /E /V /C /F /G /R /K /Y /Z /B /J
echo .
time /t
:: 
if %errorlevel% neq 0 set /a e=3
if %errorlevel% neq 0 goto ol2
echo %l2%
echo   **** Outlook Successfully Backed Up to D: FreeSpace ****
echo %l2%
echo .


:ol2
if not exist %daddio% set /a e=4
if not exist %daddio% goto ol3
echo %l2%
echo        *****   Now Syncing Calendar to Daddio   *****
echo %l2%
time /t
echo .
if %clroutdest% equ 3 del /f /s /q %daddio%"\"*.*
xcopy %source%"\"*.* %daddio% /D /E /V /C /F /G /R /K /Y /Z /B /J
echo .
time /t
if %errorlevel% neq 0 set /a e=5
if %errorlevel% neq 0 goto ol3
echo %l2%
set netw=1
echo    *****  Outlook Successfully Synced with Daddio!   *****
echo %l2%
echo .

:ol3
if not exist %backup1% set /a e=6
if not exist %backup1% goto ole
echo %l2%
echo        *****   Now Syncing Calendar to %backup1:~1,2%  *****
echo %l2%
time /t
echo .
if %clroutdest% gtr 1 del /f /s /q %backup1%"\"*.*
xcopy %source%"\"*.* %backup1% /D /E /V /C /F /G /R /K /Y /Z /B /J
echo .
time /t
if %errorlevel% neq 0 set /a e=7
if %errorlevel% neq 0 goto ole
echo %l2%
echo        **** Outlook Successfully Synced with %backup1:~1,2%  ****
echo %l2%
echo .


:: Added Recently for H: v7.9.7.63-64
:ole
if not exist %backup3% set /a e=16
if not exist %backup3% goto ol4
echo %l2%
echo        *****   Now Syncing Calendar to %backup3:~1,2%  *****
echo %l2%
time /t
echo .
if %clroutdest% gtr 1 del /f /s /q %backup3%"\"*.*
xcopy %source%"\"*.* %backup3% /D /E /V /C /F /G /R /K /Y /Z /B /J
echo .
time /t
if %errorlevel% neq 0 set /a e=17
if %errorlevel% neq 0 goto ol4
echo %l2%
echo        **** Outlook Successfully Synced with %backup3:~1,2%  ****
echo %l2%
echo .


:ol4
if not exist %backup2% set /a e=8
if not exist %backup2% goto ol5
echo %l2%
echo        *****  Now Syncing Calendar to %backup2:~1,2% *****
echo %l2%
time /t
echo .
if %clroutdest% gtr 1 del /f /s /q %backup2%"\"*.*
xcopy %source%"\"*.* %backup2% /D /E /V /C /F /G /R /K /Y /Z /B /J
echo .
time /t
if %errorlevel% neq 0 set /a e=9
if %errorlevel% neq 0 goto ol5
echo %l2%
echo        **** Outlook Successfully Synced with %backup2:~1,2%  ****


:ol5
if not exist %guruji% set /a e=10
if not exist %guruji% goto ol8
echo %l2%
echo        *****  Now Syncing Calendar to Guruji   *****
echo %l2%
time /t
echo .
set /a netw+=2
::  0==wipe none
::  1==just backups on D:
::  2==all backup drives.
::  3==network systems also.
if %clroutdest% equ 3 del /f /s /q %guruji%"\"*.*
xcopy %destin%"\"*.* %guruji% /D /E /V /C /F /G /R /K /Y /Z /B /J
echo .
time /t
if %errorlevel% neq 0 set /a e=11
if %errorlevel% neq 0 goto ol8
echo %l2%
echo      **** Outlook Successfully Synced with Guruji  ****

if not exist %daddio% set /a e=13
if not exist %daddio% goto ol6
echo %l2%
echo        ***** Now Syncing Guruji Calendar to Daddio *****
echo %l2%
time /t
echo .
if %clroutdest% equ 3 del /f /s /q %daddio%"\"*.*
xcopy %guruji%"\"*.* %daddio% /D /E /V /C /F /G /R /K /Y /Z /B /J
echo .
time /t
if %errorlevel% neq 0 set /a e=12
if %errorlevel% neq 0 goto ol6
echo %l2%
echo        **** Guruji Successfully Synced with Daddio ****


:ol8
if not exist %daddio% set /a e=13
if not exist %daddio% goto ol6
echo %l2%
echo         ***** Now Syncing Daddio Calendar to %ruser%  *****
echo %l2%
time /t
echo .
if %clroutdest% equ 4 del /f /s /q %source%"\"*.*
xcopy %daddio%"\"*.* %source% /D /E /V /C /F /G /R /K /Y /Z /B /J
echo .
time /t
if %errorlevel% neq 0 set /a e=14
if %errorlevel% neq 0 goto ol6
echo %l2%
echo      **** Outlook Successfully Synced from Daddio  ****


:ol6
:: Some erred but were forgiven!
if %e% neq 0 goto err2
if %netw% equ 0 echo %l2%
if %netw% equ 0 echo     ***** No Network Systems are Currently Online  *****
if %netw% equ 0 echo %l2%
if %netw% equ 0 goto ol7
if %netw% gtr 1 set /a netw+=-1
echo %l2%
set sys=System 
if %netw% equ 2 set sys=Systems
echo **** Outlook Successfully Synced with %netw1% Network %sys%  ****
echo %l2%


:ol7
echo .
echo %sl%
echo         *** Completion: %date% @ %time% ***
echo %sl%
echo .
goto return


:::::::::::::::::::::::::::::::::::::::::
:: Error Handling For Outlook Section. ::
:::::::::::::::::::::::::::::::::::::::::
:err2
echo %l2%
if %e% equ 0 echo %l2%
if %e% leq 0 goto ol7

:: Fatal Exceptions Defined:
if %e% equ 1 echo **** Source Files NOT Found.
if %e% equ 2 echo **** Destination Files NOT Found.
if %e% equ 3 echo **** Error while copying Source to Destination:
if %e% equ 3 set /a exit2=1

if %e% lss 4 goto fadal

:: Non-Fatal exc-Eptions Handled:
set m="ERROR!"
set /a exc=0
if %e% equ 6 set /a exc=2
if %e% equ 6 set m=  **** Backup1 (I:) is not currently online.
if %e% equ 8 set /a exc=3
if %e% equ 8 set m= **** Seagate7 (X:) is not currently online.
if %e% equ 16 set /a exc=6
if %e% equ 16 set m= **** Seagate1 (H:) is not currently online.

if %e% equ 4 set /a exc=1
if %e% equ 4 set m=    **** Daddio-PC not currently online.
if %e% equ 10 set /a exc=4
if %e% equ 10 set m=    **** Gurujimon not currently online.
if %e% equ 13 set /a exc=5
if %e% equ 13 set m=  **** Daddio-PC is not currently online.

if %exc% gtr 0 if %exc% lss 7 goto nfadal

:: Nearly-Fatal Exceptions Handled:
if %e% equ 5 set /a exc=7 
if %e% equ 5 set m=    **** Error while Copying to Daddio from Source.
if %e% equ 7 set /a exc=8
if %e% equ 7 set m=   **** Error while Copying to Backup1 from Source.
if %e% equ 9 set /a exc=9
if %e% equ 9 set m=  **** Error while Copying to Seagate7 from Source.

if %exc% gtr 0 if %exc% leq 9 goto nfadal

if %e% equ 11 set /a exc=10
if %e% equ 11 set m=        **** Error Copying from D: to Gurujimon.
if %e% equ 12 set /a exc=11
if %e% equ 12 set m=      **** Error Copying from Gurujimon to Daddio.
if %e% equ 14 set /a exc=12
if %e% equ 14 set m=   **** Error Copying back from Daddio to Source.
if %e% equ 17 set /a exc=13
if %e% equ 17 set m=     **** Error Copying to Seagate1 from Source.

:: The next 2 lines probably won't get hit,
:: but are logical & implicitely inferential.
if %exc% lss 0 goto fadal
if %e% lss 0 goto fadal


:: LAST CHANCEs fir ALL FATAL-ERoS...
:: Save for these, for they were forgiven!
:nfadal
echo .
echo %sl%
echo                ******* EXCEPTION: #%exc%  *******
echo %sl%
echo          %m% ****
echo %sl%
echo .
echo %sl%
echo                *** Non-Fatal Program Continuing...  ***
echo %sl%
echo .
:: 
set /a e=0
:: e   ^ grants a reprieve for these non-fatal eros
goto ol6 


:fadal
echo %l1%
echo .
time /t
echo           **** A Fatal Error Has Occurred! ****
echo .
echo %l2%
set msg="Recommended Pause and Investigate? (y/N): "
choice /c yn /n /t 90 /d n /m %msg%

if %errorlevel% neq 1 echo %l2%
if %errorlevel% neq 1 goto ol7
echo %l1%
echo **
:: THIS PAUSE IS PROGRAMATIC, NOT JUST TE$TCODE! KEEP
pause
echo **
goto ol7


:return


:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

:::::::::::::::::
::     EOF     ::
:::::::::::::::::
:: 100%  -JpE- ::
:::::::::::::::::

