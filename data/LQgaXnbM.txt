-- Rex. E#0001
-- FIGHT THE MONSTERS! (FIXED) Kill aura
local Player = game:GetService("Players").LocalPlayer
local Character = Player.Character
local RootPart = Character:FindFirstChild("HumanoidRootPart")
local MobHolder = workspace.MobHolder
local RunService = game:GetService("RunService")
local RenderStepped = RunService.RenderStepped
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local GameRemotes = ReplicatedStorage.GameRemotes
local DamageEvent = GameRemotes.DamageEvent
_G.AutoFarm = true

function findNearestTorso(pos)
    local list = MobHolder:GetDescendants()
    local torso = nil
    local dist = math.huge
    local temp = nil
    local temp2 = nil
    local human = nil
    for x = 1, #list do
        temp2 = list[x]
        if (temp2.className == "Model") and (temp2 ~= script.Parent) then
            temp = temp2:FindFirstChild("Head")
            human = temp2:FindFirstChildOfClass("Humanoid")
            if (temp ~= nil) and (human ~= nil) and (human.Health > 0) then
                if (temp.Position - pos).magnitude < dist then
                    torso = temp
                    dist = (temp.Position - pos).magnitude
                end
            end
        end
    end
    return torso
end

while RenderStepped:Wait() and _G.AutoFarm do
    local NPC = findNearestTorso(RootPart.Position).Parent
    if Character:FindFirstChildOfClass("Tool") then
        local Tool = Character:FindFirstChildOfClass("Tool")
        if NPC:FindFirstChild("Head") and NPC:FindFirstChild("Enemy") then
            pcall(function() DamageEvent:FireServer(NPC:FindFirstChild("Head"),NPC:FindFirstChild("Enemy"),Tool) end)
        end
    end
end