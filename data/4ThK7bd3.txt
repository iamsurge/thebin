#!/usr/bin/env python
# -*- coding: utf-8 -*-
#
# Script que simula un comando dir de windows

import os
from datetime import datetime
from tabulate import tabulate

directorio = "."
tabla = []

# escaneo el directorio en cuestion
for entrada in os.scandir(directorio):
    info = entrada.stat()
    ult_mod = datetime.utcfromtimestamp(info.st_mtime).strftime("%d-%b-%y %H:%M")
    
    if entrada.is_file():
        tamanio = info.st_size
        
        if tamanio < 1024:
            tamanio = f"{tamanio} B"
            
        elif 1024 <= tamanio < 1024**2:
            tamanio = f"{tamanio/1024:.1f} KB"
        
        else:
            tamanio = f"{tamanio/1024**2:.1f} MB"
           
        tabla.append([ult_mod, "", tamanio, entrada.name])
        
    
    elif entrada.is_dir():
        tabla.append([ult_mod, "<DIR>", "",entrada.name])
        
print(tabulate(
            tabla,
            tablefmt = "plain",
            colalign = ["left", "center", "right", "left"]
        )
    )
        