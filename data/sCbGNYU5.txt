CREATE DATABASE apotek;
USE apotek ;
DROP DATABASE apotek;
-- -----------------------------------------------------
-- Table pasien
-- -----------------------------------------------------
CREATE TABLE pasien (
  nopasien INT PRIMARY KEY,
  nama VARCHAR(45),
  alamat VARCHAR(45),
  pekerjaan VARCHAR(45),
  noktp VARCHAR(16));
desc pasien;

-- -----------------------------------------------------
-- Table pasien_no_bpjs
-- -----------------------------------------------------
CREATE TABLE pasien_non_bpjs (
  nopasien INT PRIMARY KEY,
  faskes VARCHAR(45));
alter table pasien_non_bpjs add foreign key(nopasien) references pasien(nopasien);
desc pasien_non_bpjs;

-- -----------------------------------------------------
-- Table pasien_bpjs
-- -----------------------------------------------------
CREATE TABLE pasien_bpjs (
  nopasien INT PRIMARY KEY,
  nik_bpjs VARCHAR(45),
  jenisbpjs VARCHAR(45));
alter table pasien_bpjs add foreign key(nopasien) references pasien(nopasien);
desc pasien_bpjs;

-- -----------------------------------------------------
-- Table notelpasien
-- -----------------------------------------------------
CREATE TABLE notelppasien (
  nopasien INT PRIMARY KEY,
  no_tlp VARCHAR(45));
alter table notelppasien add foreign key(nopasien) references pasien(nopasien);
desc notelppasien;

-- -----------------------------------------------------
-- Table kategori_obat
-- -----------------------------------------------------
CREATE TABLE kategori_obat (
  id_kategori INT PRIMARY KEY,
  nama VARCHAR(50),
  kategori VARCHAR(45),
  keterangan VARCHAR(45));
desc kategori_obat;

-- -----------------------------------------------------
-- Table obat
-- -----------------------------------------------------
CREATE TABLE obat (
  kode_obat INT PRIMARY KEY,
  id_kategori INT,
  merkobat VARCHAR(45),
  hargasatuan INT,
  dosis VARCHAR(45),
  jumlah INT);
alter table obat add foreign key(id_kategori) references kategori_obat(id_kategori);
desc obat;

-- -----------------------------------------------------
-- Table pegawai
-- -----------------------------------------------------
CREATE TABLE pegawai (
  id_pegawai INT PRIMARY KEY,
  nama VARCHAR(50),
  alamat VARCHAR(45),
  jabatan VARCHAR(45),
  no_ktp CHAR(16));
desc pegawai;

-- -----------------------------------------------------
-- Table notelppegawai
-- -----------------------------------------------------
CREATE TABLE notelppegawai (
  id_pegawai INT PRIMARY KEY,
  no_telp VARCHAR(16));
alter table notelppegawai add foreign key(id_pegawai) references pegawai(id_pegawai);
desc notelppegawai;

-- -----------------------------------------------------
-- Table pembayaran
-- -----------------------------------------------------
CREATE TABLE pembayaran (
  id_bayar INT PRIMARY KEY,
  id_pegawai INT,
  tgl_pembayaran DATE,
  jumlah_bayar INT,
  sisa_puitang INT);
alter table pembayaran add foreign key(id_pegawai) references pegawai(id_pegawai);
desc pembayaran;


-- -----------------------------------------------------
-- Table resep
-- -----------------------------------------------------
CREATE TABLE resep (
  noresep INT PRIMARY KEY,
  nopasien INT,
  id_bayar INT,
  tglresep DATE,
  asaldokter VARCHAR(45),
  total INT);
alter table resep add foreign key(nopasien) references pasien(nopasien);
alter table resep add foreign key(id_bayar) references pembayaran(id_bayar);
desc resep;

-- -----------------------------------------------------
-- Table detail_obat
-- -----------------------------------------------------
CREATE TABLE detail_obat (
  id_det_ob INT PRIMARY KEY,
  noresep INT,
  kode_obat INT,
  subtotal INT,
  jumlah INT);
alter table detail_obat add foreign key(noresep) references resep(noresep);
alter table detail_obat add foreign key(kode_obat) references obat(kode_obat);
desc detail_obat;

-- -----------------------------------------------------
-- Table retur
-- -----------------------------------------------------
CREATE TABLE retur (
  id_retur INT PRIMARY KEY,
  tglretur DATE);
desc retur;
-- -----------------------------------------------------
-- Table detail_retur
-- -----------------------------------------------------
CREATE TABLE detail_retur (
  id_retur INT PRIMARY KEY,
  id_det_ob INT NOT NULL);
alter table detail_retur add foreign key(id_retur) references retur(id_retur);
alter table detail_retur add foreign key(id_det_ob) references detail_obat(id_det_ob);
desc detail_retur;
