package com.mycompany.javacomsql;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.List;

/**
 *
 * @author User
 */
public class Categorias {

    private int codigoCategoria;
    private String categoria;
    private int posicao;

    public int getCodigoCategoria() {
        return codigoCategoria;
    }

    public void setCodigoCategoria(int codigoCategoria) {
        this.codigoCategoria = codigoCategoria;
    }

    public String getCategoria() {
        return categoria;
    }

    public void setCategoria(String categoria) {
        this.categoria = categoria;
    }

    public int getPosicao() {
        return posicao;
    }

    public void setPosicao(int posicao) {
        this.posicao = posicao;
    }

    public void listar() {

        Conexao conexao = new Conexao();
        Connection conn = conexao.conectar();

        try {
            String sql = "Select * from categoria";

            Statement stmt = conn.createStatement();

            ResultSet rs = stmt.executeQuery(sql);

            while (rs.next()) {
//Retrieve by column name
                int codigoCategoria = rs.getInt("codCategoria");
                String categoria = rs.getString("categoria");
                int posicao = rs.getInt("posicao");
                System.out.println("Código: " + codigoCategoria + " categoria: " + categoria + " Posição: " + posicao);

            }

            stmt.close();
            conexao.desconectar(conn);

        } catch (SQLException ex) {
            System.out.println("Erro " + ex);
        }

    }

    public void inserir() {

        Conexao conexao = new Conexao();
        Connection conn = conexao.conectar();

        try {
            String sql = "INSERT INTO `categoria` (`codCategoria`, `categoria`, `posicao`) VALUES (NULL, '" + this.categoria + "', '" + this.posicao + "');";

            Statement stmt = conn.createStatement();

            ResultSet rs = stmt.executeQuery(sql);

            stmt.close();
            conexao.desconectar(conn);

        } catch (SQLException ex) {
            System.out.println("Erro " + ex);
        }

    }
    
    public void alterar() {

        Conexao conexao = new Conexao();
        Connection conn = conexao.conectar();
        

        try {
            String sql = "UPDATE `categoria` SET `categoria` = '"+this.categoria+"', `posicao` = '"+this.posicao+"' WHERE `categoria`.`codCategoria` = "+this.codigoCategoria;

            Statement stmt = conn.createStatement();

            ResultSet rs = stmt.executeQuery(sql);

            stmt.close();
            conexao.desconectar(conn);
            

        } catch (SQLException ex) {
            System.out.println("Erro " + ex);
        }

    }
    public void excluir() {

        Conexao conexao = new Conexao();
        Connection conn = conexao.conectar();
        

        try {
            String sql = "Delete from `categoria`  WHERE `categoria`.`codCategoria` = "+this.codigoCategoria;

            Statement stmt = conn.createStatement();

            ResultSet rs = stmt.executeQuery(sql);

            stmt.close();
            conexao.desconectar(conn);
            

        } catch (SQLException ex) {
            System.out.println("Erro " + ex);
        }

    }
    
    public List combo(){
    
    List<String> strList = new ArrayList<String>();
   
    Conexao conexao = new Conexao();
    Connection conn = conexao.conectar();

        try {
            String sql = "Select * from categoria order by posicao";

            Statement stmt = conn.createStatement();

            ResultSet rs = stmt.executeQuery(sql);

            while (rs.next()) {
                strList.add(rs.getString("categoria"));
    
            }

            stmt.close();
            conexao.desconectar(conn);

        } catch (SQLException ex) {
            System.out.println("Erro " + ex);
        }   

    
    return strList;
    }

}