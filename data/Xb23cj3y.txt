#include <stdio.h>

char input[] = R"(addx 15
...
)";

int main()
{
    int i = 0;
    int regX = 1;
    int xpos = 0;
    int val = 0;
    int sign = 0;

    while (input[i])
    {
        char c = input[i++];
        switch (c)
        {
        case ' ':
            sign = 1;
            putc((xpos == regX) || (xpos == regX + 1) || (xpos == regX - 1) ? '#' : '.', stdout);
            xpos = (++xpos) % 40;
            if (!xpos) putc('\n', stdout);
            break;
        case '\n':
            putc((xpos == regX) || (xpos == regX + 1) || (xpos == regX - 1) ? '#' : '.', stdout);
            xpos = (++xpos) % 40;
            regX += val;
            val = 0;
            sign = 0;
            if (!xpos) putc('\n', stdout);
            break;
        case '-':
            sign = -1;
            break;
        default:
            val = val * 10 + sign * (c - '0');
        }
    }

    return 0;
}
