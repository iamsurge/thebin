"#include <bits/stdc++.h>\r\n#define pii pair<int, int>\r\n#define fi first\r\n#define se second\r\n#define ll long long\r\nusing namespace std;\r\nconst int N = 2e5 + 5;\r\nvector<int> gr[N];\r\npii p[N];\r\nll ans;\r\n/*\r\nf(a, b, c, n) = (a*i+b)/c, 0 <= i <= n\r\na < n, b < n\r\nk = (a*n+b)/c\r\nfor(i, 0, n)\r\n    for(j, 0, k-1)ans += (j < (a*i+b)/c)\r\nfor(j, 0, k-1)\r\n    for(i, 0, n)ans += (j < (a*i+b)/c)\r\nfor(j, 0, k-1)\r\n    for(i, 0, n)ans += (j*c+c <= a*i+b)\r\nfor(j, 0, k-1)\r\n    for(i, 0, n)ans += ((j*c+c-b-1)/a < i)\r\nfor(j, 0, k-1)\r\n    ans += n-(j*c+c-b - 1)/a;\r\n= n*k-f(c, c-b-1 , a, k-1)\r\n*/\r\nll f(ll a, ll b, ll c, ll n)\r\n{\r\n\r\n    if (a == 0)\r\n        return (n + 1) * (b / c);\r\n    if (a >= c || b >= c)\r\n        return f(a % c, b % c, c, n) + n * (n + 1) / 2 * (a / c) + (n + 1) * (b / c);\r\n    ll k = (a * n + b) / c;\r\n    return n * k - f(c, c - b - 1, a, k - 1);\r\n}\r\nint main()\r\n{\r\n    ios_base::sync_with_stdio(0),\r\n        cin.tie(0);\r\n    int t;\r\n    cin >> t;\r\n    while (t-- > 0)\r\n    {\r\n        ll a, b, c, d;\r\n        cin >> a >> b >> c >> d;\r\n        int k = (d - 2) / (c - b);\r\n        ans = k - f(c, a, d, k) + f(b, a - 1, d, k);\r\n        cout << ans << '\\n';\r\n    }\r\n}"