install.packages("pscl")
install.packages("randomForest")
install.packages("doParallel")
library(pscl)
library(randomForest)
library(doParallel) 

detectCores() # Смотрим доступное число ядер
#y = c(0, 0, 0)

system.time({iris_rf <- randomForest(Species~.,data=iris,ntree=500,proximity=TRUE)})
varImpPlot(iris_rf)
importance(iris_rf)
iris_rf
#y[1]=t[3]

# Функция принимает число ядер, возвращает затраченное время
calc_time <- function(c){
  registerDoParallel(cores = c)
  t <- system.time({iris_rf2 <- foreach(ntree=rep(100,5), .combine=combine, .packages=c('randomForest',"pscl")) %dopar% randomForest(Species~.,data=iris,ntree=ntree,proximity=TRUE)})
  print(t)
  return(t[3])
}

# 1
x<-c(1, 2, 4)
y <- c(calc_time(1), calc_time(2), calc_time(4))
plot(x, y, type="o", xlab = "Число ядер", ylab= "Время")