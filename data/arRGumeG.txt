SendMode Input  ; Recommended for new scripts due to its superior speed and reliability.
SetWorkingDir %A_ScriptDir%  ; Ensures a consistent starting directory.

SlotCount := 32

XButton1::
	pickedup := !pickedup
	
	If pickedup {
		Send, t^a/crate pickup`n
		sleep, 500
		Send, {down 2}`n
	} else {
		Send, t^a/crate putdown`n
	}
Return

XButton2:: 
	pickedup := !pickedup
Return

!1::
	unloading := true
	SlotNum := 1
	While (A_Index < SlotCount+1 and unloading)
	{
		Send, t^a/crate pickup`n
		sleep, 500
		if (SlotNum = 1) {
			Send, {enter}
		} else {
			if (slotNum = 11) {
				Send, {down 10}
				Send, {enter}
				sleep, 1000
				Send, {enter}
				slotNum = 1
			} else {
				downs := SlotNum-1
				Send, {down %downs%}{enter}
			}
		}
		
		SlotNum += 1
		sleep, 2000
		send, t^a/crate putdown`n
		sleep, 2000
	}
	unloading := false
Return

#if unloading
	1:: unloading := false