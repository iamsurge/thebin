

@echo off
title *** SyncOldPhotos.bat by -JpE- 20220503025911 ***
set ruser=JpE
:: TestsNOTwell Simplified to a folder or computer. Oh well.
set ace="\\DADDIO-PC\Daddio_Older_Photos\125 NASA Pictures (Illuminati, Freemasons)\ace1.jpg"
::
set bats=C:\Users\%ruser%\Documents\AAA Sync2Laptop\Batch Files\BCS-Suite
:: 
set logfile="%bats%\SyncOlderPhotos_Log.txt"
:: Set Alias for Long Line, Short Line, Docs & LogFile.
set sl=         /*\/*\/*\/*\/*\/*\/*\/*\/*\/*\/*\/*\/*\/*\
set l1=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=
set l2=\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/

if exist %fileo% goto start
:: If ^ not AAA calling, set time var to now:
set timethen=%time%
set datethen=%date%
set fileo="%bats%\caller_check.txt"
set RunT="%bats%\runtime_display.bat"
:: ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


:start
set /a sup=0
set /A dad=0
set /A bup=0

:restart
set ver=v7.9.7.65 20221104133824
set /A aok=0
echo .
echo .
::
set b1=****************************************************************
set b2=**   ******************************************************   **
set b3=***   ***   ***   ***   ***   ****   ***   ***   ***   ***   ***
echo %b1%
echo %b3%
echo %b1%
echo **   *                         *                          *   **
echo **   ****       *    Custom Software by JpE    *       ****   **
echo **      *                      *                       *      **
echo %b2%
echo %b2%
echo **   **    THIS WILL Synchronize One Drive or            **   **
echo **   **    Directory to another. It should only copy     **   **
echo **   **    FILES THAT HAVE CHANGED BTW. COOL!!!          **   **
echo **   **    -JpE @ 5:58 AM 8/16/2008                      **   **
echo **   **    ReArranged:  1:07 AM 2/2/2010                 **   **
echo **   **    ------------------------------------------    **   **
echo **   **    Adapted 20210421021349 SyncOlderPhotos.bat    **   **
echo %b2%
echo %b2%
echo **                                                            **
echo **      Run from the JpE Side Only. 20220420042022            **
echo **                                                            **
echo **      %ver%  by -JpE-                    **
echo %b1%
echo %b3%
echo %b2%
echo **      Syncing older photos with Daddio and running backups. **
::
echo %b1%
echo **      Today is %datethen% and It is now %timethen%         ** 
echo %b1%
if %bup% gtr 0 goto externals
if %sup% gtr 0 goto externals
if not exist %ace% goto skipit


:: Daddio is Online
echo **      Please wait. Bringing in Older_Photos from Daddio.    **
echo %b1%
::
set source0="\\DADDIO-PC\Daddio_Older_Photos"
set destin0="D:\Older_Photos"
:: *****************************************************************
xcopy %source0% %destin0% /D /E /V /C /F /G /R /K /Y /B
:: *****************************************************************
echo %b1%
echo **      Today is %date% and It is now %time%         **
echo %b1%
if %errorlevel% equ 0 set /A aok+=1
if %aok% equ 0 goto skipit

echo **      Daddio is Online! Now Syncronizing...                 **
echo %b1%
set task=Tasks
if %aok% equ 1 set task=Task 
echo **      %aok% %task% Completed: Daddio Brought in.                 **
echo %b1%
echo **      Please wait while we Sync back to Daddio...           **
echo %b1%

set source1="D:\Older_Photos"
set destin1="\\DADDIO-PC\Daddio_Older_Photos"
xcopy %source1%"\"*.* %destin1% /D /E /V /C /F /G /R /K /Y /B
echo %b1%
if %errorlevel% equ 0 set /A aok+=1
echo **      Today is %date% and It is now %time%         ** 
echo %b1%
if %aok% lss 2 goto skipit

set task=Tasks
if %aok% equ 1 set task=Task 
echo **      %aok% %task% completed: Docs Synced to DADDIO.             **
echo %b1%
echo **      Now Syncing to External if available.                 **


:skipit
if %aok% neq 0 goto externals
echo **      DADDIO is NOT Online Right Now.                       **
set /A dad+=1
goto retry


:externals
echo %b1%
set source2="D:\Older_Photos"
set destin3="I:\Older_Photos"
set destin2="X:\%ruser%-PC\Older_Photos"
:: New var destin4, thread it through like the rest.
set destin4="H:\Older_Photos"

set /A which=0
if exist %destin2% set /A which+=1
if exist %destin3% set /A which+=2
if exist %source2% set /a which+=4
if exist %destin4% set /a which+=8


if %which% lss 4 echo **      Photos Source drive is currently Offline.             **
if %which% lss 4 set /a sup+=1
if %which% lss 4 goto retry

if exist %destin2% goto backup
if exist %destin3% goto backup
if exist %destin4% goto backup
:: NOTE: Doesn't return here in this language so this is okay.

echo **      No backup drives are currently Online.                **
set /A bup+=1


:retry
if %sup% gtr 7 goto ending
if %bup% gtr 3 goto ending
if %dad% gtr 3 goto externals

:: Can't default to Yes or it would hang below foreverafter.
set msg="**      Bring it online and try again? (y\N): "
choice /c yn /n /t 30 /d n /m %msg%

if %errorlevel% gtr 1 if %bup% gtr 0 goto ending
if %errorlevel% gtr 1 if %sup% gtr 1 goto ending
if %errorlevel% gtr 1 goto externals

echo **      Press any key when ready to try again.                **
echo %b1%
echo **
pause
:: Programmatic pause for user action.
echo **
echo %b1%
goto restart


:backup
echo **      Please wait while I check our backup archives.        **
echo %b1%

:: *****************************************************************
:: if (%which% equ 1+4 or %which% equ 3+4) 
if %which% equ 0 goto ending
if %which% leq 4 goto ending
if %which% equ 6 goto backup1
if not exist %destin2% goto backup1

xcopy %source2%"\"*.* %destin2% /D /E /V /C /F /G /R /K /Y /B
:: *****************************************************************
echo %b2%
if %errorlevel% equ 0 set /A aok+=1
if %errorlevel% neq 0 goto backup1
echo **      Success! %destin2% is NOW Up to Date.
echo %b2%
if %which% equ 5 goto success
if not exist %destin3% goto backup2


:backup1
xcopy %source2%"\"*.* %destin3% /D /E /V /C /F /G /R /K /Y /B
:: *****************************************************************
echo %b2%
if %errorlevel% equ 0 set /A aok+=1
if %errorlevel% neq 0 goto ending
echo **     Success! %destin3% is NOW Up to Date.
echo %b2%


:: Added Later mod
if %which% lss 8 goto success
:backup2
xcopy %source2%"\"*.* %destin4% /D /E /V /C /F /G /R /K /Y /B
:: *****************************************************************
echo %b2%
if %errorlevel% equ 0 set /a aok+=1
if %errorlevel% neq 0 goto ending
echo **     Success! %destin4% is NOW Up to Date.
echo %b2%


:success
set txt=Backup 
if %which% geq 7 set txt=Backups
echo **      Process Finished: External %txt% Completed.         **


:ending
set task=Task 
if %aok% neq 1 set task=Tasks
echo **      %aok% %task% Completed: Program Terminating.               **
echo %b1%
echo **      Today is %date% and It is now %time%         ** 
echo %b1%

if exist %fileo% goto noexit
:: if called by AAA-Sync.bat, do RunT at the end of it instead.

if not exist %RunT% echo %RunT% cannot be found!
if exist %RunT% call %RunT%
:: See modifications in runtime_display.bat


:bbye
echo %l1%
set msg="**      S)tart over, P)ause or Q)uit? (Q): "
choice /c spq /n /t 20 /d q /m %msg%
echo %b1%
if %errorlevel% equ 1 goto start
if %errorlevel% neq 2 goto noexit
:: This pause is programmed and not just for testing.
echo **
pause
echo **
goto bbye


:noexit

:: Ttttttttthhhhhhhaaaaaatttttttssssss ALL Folks!

:: EOF 100% -JpE-


