    .text
    .global sort_by_abs
sort_by_abs:
    pushl %ebp
    movl %esp, %ebp

    pushl %esi
    pushl %edi

    movl 8(%esp), %esi // адрес начала
    movl 12(%esp), %edi // количество элементов

    pushl $comparator
    pushl $2
    pushl %edi
    pushl %esi
    call qsort

    addl $16, %esp
    
    popl %edi
    popl %esi

    xorl %eax, %eax
    movl %ebp, %esp
    popl %ebp
    ret

comparator:
    pushl %ebp
    movl %esp, %ebp

    movl 8(%esp), %eax // первый
    movl 12(%esp), %ecx // второй

    cmpl $0, %eax
    jl first_neg

    cmpl $0, %ecx
    jl second_neg

    jmp both_pos

first_neg:
    cmpl $0, %ecx
    jl both_neg

    xorl %edx, %edx
    subl %ecx, %edx
    movl %edx, %ecx
    jmp both_neg

second_neg:
    xorl %edx, %edx
    subl %ecx, %edx
    movl %edx, %ecx
    jmp both_pos

both_pos:
    cmpl %ecx, %eax
    jg second_larger

    cmpl %ecx, %eax
    jl first_larger

    movl $0, %eax
    jmp fin_conparator

both_neg:
    cmpl %ecx, %eax
    jg first_larger

    cmpl %ecx, %eax
    jl second_larger

    movl $0, %eax
    jmp fin_conparator

first_larger:
    movl $1, %eax
    jmp fin_conparator

second_larger:
    movl $-1, %eax
    jmp fin_conparator

fin_conparator:
    movl %ebp, %esp
    popl %ebp
    ret
