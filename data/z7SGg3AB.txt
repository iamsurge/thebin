#NoEnv  ; Recommended for performance and compatibility with future AutoHotkey releases.
#Warn  ; Enable warnings to assist with detecting common errors.
#UseHook On ; Keyboard hook
#SingleInstance force
SendMode Input  ; Recommended for new scripts due to its superior speed and reliability.
SetWorkingDir %A_ScriptDir%  ; Ensures a consistent starting directory.

#If WinActive("ahk_class TfMain") and WinActive("ahk_exe FlashpointCampaigns.exe")

; Suspend: Pause
Pause::Suspend

;WASD keys scroll + context nav
w::Send {Up}{Numpad8}
a::Send {Left}{Numpad4}
s::Send {Down}{Numpad2}
d::Send {Right}{Numpad6}

;Arrow keys scroll + context nav
Up::Send {Up}{Numpad8}
Left::Send {Left}{Numpad4}
Down::Send {Down}{Numpad2}
Right::Send {Right}{Numpad6}

; Hotkey remapping
Space::Send {Enter}		;	Enter
e::Send {Click,right}	;	Right-click
Tab::Send ^n					; Tab - Next Unit
+Tab::Send ^b					; Shift+Tab - Previous Unit

q::Send {F4}	;	Q - Unit Dashboard
+q::Send {F6}	; Shift+Q - Subunit Inspector
+s::Send ^k		;	Shift+S - SOP Manager
|::Send {F7}	; | - Log
r::Send ^r		;	R - Rotate Stack
f::Send ^l		; F - Line-Of-Sight
g::Send ^o		;	G - Spottable From
h::Send ^d		;	H - Range Rings
y::Send ^p		; Y - SOP Ranges
t::Send ^y		;	T - Enemies Spotted
v::Send ^u		;	V - Hide Units
c::Send {Numpad5}	; C - Center on current hex

; Zoom controls
z::Send {WheelUp}		;	Zoom In
x::Send {WheelDown}	; Zoom Out

#IfWinActive ; End main

; UNIT DASHBOARD
#IfWinActive ahk_class TfUnitDashboardNew
q::Send !{F4} ; q - Close Unit Dashboard
Esc::Send !{F4} ; Esc - Close Unit Dashboard
#IfWinActive

; SUBUNIT INSPECTOR
#IfWinActive ahk_class TfSubunitInspector2
+q::Send {F6} ; Shift+Q - Close SubUnit Inspector
Esc::Send {F6} ; Esc - Close SubUnit Inspector
#IfWinActive

; SOP MANAGER
#IfWinActive ahk_class TfSOPInspector
+s::Send !{c} ; Shift+S - Close SOP Manager
Esc::Send !{c} ; Esc - Close SOP Manager
#IfWinActive
