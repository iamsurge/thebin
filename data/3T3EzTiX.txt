#!/usr/bin/env python
# -*- coding: utf-8 -*-
#
# Script que implementa una calculadora científica básica

## python -m pip install pyinstaller
## pyinstaller --onefile --noconsole acme.py



import tkinter as tk
from math import sqrt, factorial, pi

def limpieza():
    global calculo_consola
    calculo.set("0")        # se pone en cero la pantalla
    calculo_consola = ""    # borro la cuenta de la consola
    
    
def clic(tecla):
    global calculo_consola
    calculo_consola = calculo_consola + tecla
    calculo.set(calculo_consola)
    
    

def hacer_cuenta():
    global calculo_consola
    try:
        total = str(eval(calculo_consola))
    except Exception:
        limpieza()
        total = "ERROR"
    calculo.set(total)
    calculo_consola = ""
        

    
def borrar_caracter():
    global calculo_consola
    if len(calculo_consola) > 1:
        calculo_consola = calculo_consola[:-1]
        calculo.set(calculo_consola)
    else:
        calculo_consola = ""
        calculo.set("0")
    



# ventana para contener la calculadora
ventana = tk.Tk()
ventana.title("Calculadora ACME")
ventana.config(width=390, height=600, bg="Light Steel Blue")
ventana.resizable(0,0)

# creo una variable string gràfica para mostrar el cálculo en la pantalla
# de la calculadora
calculo = tk.StringVar()

# llamo a una función que limpie la pantalla antes de empezar
limpieza()

# creo la pantalla
pantalla = tk.Entry(
        font = ("arial",20,"bold"),
        width = 20,
        bd = 18,
        bg = "powder blue",
        justify = "right",
        state = tk.DISABLED,
        textvariable = calculo
        )
pantalla.place(x=20, y=50)

# defino las dimensiones de las teclas
ancho = 10
alto = 2

# creo una variable para almacenar el cálculo del lado de la consola
calculo_consola = ""


######################   TECLAS  ##########################

# tecla para borrar el ultimo caracter ingresado
tecla = tk.Button(text="DEL", width=ancho, height=alto, bg="medium aquamarine", command=borrar_caracter)
tecla.place(x=287, y=140)


### Primera fila: 1 2 3 +  ######
tecla = tk.Button(text="1", width=ancho, height=alto, command=lambda:clic("1"))
tecla.place(x=17, y=200)

tecla = tk.Button(text="2", width=ancho, height=alto, command=lambda:clic("2"))
tecla.place(x=107, y=200)

tecla = tk.Button(text="3", width=ancho, height=alto, command=lambda:clic("3"))
tecla.place(x=197, y=200)

tecla = tk.Button(text="+", width=ancho, height=alto, bg="Steel Blue", command=lambda:clic("+"))
tecla.place(x=287, y=200)



### Segunda fila: 4 5 6 -  ######
tecla = tk.Button(text="4", width=ancho, height=alto, command=lambda:clic("4"))
tecla.place(x=17, y=260)

tecla = tk.Button(text="5", width=ancho, height=alto, command=lambda:clic("5"))
tecla.place(x=107, y=260)

tecla = tk.Button(text="6", width=ancho, height=alto, command=lambda:clic("6"))
tecla.place(x=197, y=260)

tecla = tk.Button(text="-", width=ancho, height=alto, bg="Steel Blue", command=lambda:clic("-"))
tecla.place(x=287, y=260)


### Tercera fila: 7 8 9 x  ######
tecla = tk.Button(text="7", width=ancho, height=alto, command=lambda:clic("7"))
tecla.place(x=17, y=320)

tecla = tk.Button(text="8", width=ancho, height=alto, command=lambda:clic("8"))
tecla.place(x=107, y=320)

tecla = tk.Button(text="9", width=ancho, height=alto, command=lambda:clic("9"))
tecla.place(x=197, y=320)

tecla = tk.Button(text="x", width=ancho, height=alto, bg="Steel Blue", command=lambda:clic("*"))
tecla.place(x=287, y=320)



### Cuarta fila: ( 0 ) /  ######
tecla = tk.Button(text="(", width=ancho, height=alto, bg="Steel Blue2", command=lambda:clic("("))
tecla.place(x=17, y=380)

tecla = tk.Button(text="0", width=ancho, height=alto, command=lambda:clic("0"))
tecla.place(x=107, y=380)

tecla = tk.Button(text=")", width=ancho, height=alto, bg="Steel Blue2", command=lambda:clic(")"))
tecla.place(x=197, y=380)

tecla = tk.Button(text="/", width=ancho, height=alto, bg="Steel Blue", command=lambda:clic("/"))
tecla.place(x=287, y=380)


### Quinta fila: Raiz, coma decimal, potencia, resto  ######
tecla = tk.Button(text="\u221A", width=ancho, height=alto, bg="Steel Blue3", command=lambda:clic("sqrt("))
tecla.place(x=17, y=440)

tecla = tk.Button(text=".", width=ancho, height=alto, bg="Steel Blue2", command=lambda:clic("."))
tecla.place(x=107, y=440)

tecla = tk.Button(text="POW", width=ancho, height=alto, bg="Steel Blue3", command=lambda:clic("**"))
tecla.place(x=197, y=440)

tecla = tk.Button(text="%", width=ancho, height=alto, bg="Steel Blue3", command=lambda:clic("%"))
tecla.place(x=287, y=440)



### Sexta fila: Clear Factorial PI =  ######
tecla = tk.Button(text="CL", width=ancho, height=alto, bg="medium aquamarine", command=limpieza)
tecla.place(x=17, y=500)

tecla = tk.Button(text="!", width=ancho, height=alto, bg="Steel Blue3", command=lambda:clic("factorial("))
tecla.place(x=107, y=500)

tecla = tk.Button(text="\u03c0", width=ancho, height=alto, bg="Steel Blue3", command=lambda:clic(str(pi)))
tecla.place(x=197, y=500)

tecla = tk.Button(text="=", width=ancho, height=alto, bg="medium aquamarine", command=hacer_cuenta)
tecla.place(x=287, y=500)





ventana.mainloop()
