// Checks for validity and type of credit card number (VISA, AMEX, Mastercard)
#include <cs50.h>
#include <stdio.h>

// Makes a sum of the digits that make up an integer
int getSum(int a)
{
    int sum = 0;
    while (a != 0)
    {
        sum = sum + a % 10;
        a = a / 10;
    }
    return sum;
}

int main(void)
{
    // Initializes variables
    bool amex, visa, mastercard = 0;
    int sum1, sum2, checksum = 0;
    unsigned long long n = get_long("Number: ");
    long lastdigit;
    int digit1, digit12;
    for (int i = 1; n > 0; n /= 10, i++)
    {
        // Makes a sum of the second-to-last digit and every other digit multiplied by 2
        if (i % 2 == 0)
        {
            lastdigit = n % 10;
            sum1 = sum1 + getSum(lastdigit * 2);
        }
        // Makes a sum of the last digit and every other digit
        else
        {
            lastdigit = n % 10;
            sum2 = sum2 + lastdigit;
        }
        // Collects the first two digits and the first digit of the number in two variables
        if (n >= 10)
        {
            digit12 = n;
            digit1 = digit12 / 10;
        }
        // Checks for AMEX, VISA and Mastercard requirements
        if (i == 15 && (digit12 == 34 || digit12 == 37))
        {
            amex = 1;
        }
        else if ((i == 13 || i == 16) && digit1 == 4)
        {
            visa = 1;
        }
        else if (i == 16 && (digit12 >= 51 && digit12 <= 55))
        {
            mastercard = 1;
        }
    }
    // Checks for number validity and prints out card issuer if valid card number
    checksum = sum1 + sum2;
    if (checksum % 10 == 0)
    {
        if (amex == 1)
        {
            printf("AMEX\n");
        }
        else if (visa == 1)
        {
            printf("VISA\n");
        }
        else if (mastercard == 1)
        {
            printf("MASTERCARD\n");
        }
        // Prints out INVALID if number is valid but not a credit card number
        else if (amex == 0 && visa == 0 && mastercard == 0)
        {
            printf("INVALID\n");
        }
    }
    else
    {
        printf("INVALID\n");
    }
}