-- Задание 1
SELECT SNUM
FROM Orders
GROUP BY SNUM;

-- Задание 2
SELECT SNAME
FROM Salespeople
WHERE CITY = 'London';

-- Задание 3
SELECT *
FROM Customers
WHERE SNUM = 1001;

-- Задание 4
SELECT CNAME, RATING
FROM Customers
WHERE CITY = 'San Jose';

-- Задание 5
SELECT *
FROM Orders
WHERE ONUM IN
	(SELECT ONUM
		FROM Order_Details JOIN Product
		ON Order_Details.PNUM = Product.PNUM
		WHERE Product.PRICE * QUANTITY > 4000);

-- Задание 6
SELECT *
FROM Customers
WHERE CITY = 'San Jose' AND RATING > 200;

-- Задание 7
SELECT *
FROM Customers
WHERE CITY = 'San Jose' OR RATING <= 200;

-- Задание 8
SELECT *
FROM Customers
WHERE RATING <= 100 AND CITY = 'Rome';

-- Задание 9
-- AMT удаляется потому что уже существуют вспомогательные таблицы с ценами
ALTER TABLE Orders
DROP COLUMN AMT;

-- Задание 10
SELECT *
FROM Customers
WHERE CNAME LIKE 'G%';

-- Задание 11
SELECT SNUM, SNAME, CITY
FROM Salespeople
UNION ALL
SELECT CNUM, CNAME, CITY
FROM Customers;

-- Задание 12
SELECT CNAME, RATING, CITY, CASE WHEN RATING >= 200 THEN 'High Rating'
								ELSE 'Low Rating'
							END AS Comment
FROM Customers;

-- Задание 13
SELECT *
FROM Orders JOIN Customers -- JOIN по-умолчанию INNER
ON Orders.CNUM = Customers.CNUM
WHERE Customers.CNAME = 'Cisneros';

-- Задание 14
SELECT ONUM, ODATE
FROM Orders JOIN Salespeople
ON Orders.SNUM = Salespeople.SNUM
WHERE Salespeople.SNAME = 'Rifkin';

-- Задание 15
SELECT SNAME, COUNT(SNAME) as 'Количество заказов'
FROM Salespeople JOIN Orders
ON Salespeople.SNUM = Orders.SNUM
GROUP BY Salespeople.SNAME;

-- Задание 16
SELECT Orders.ONUM, PRICE * QUANTITY as 'Сумма заказа'
FROM Orders JOIN Order_Details ON Orders.ONUM = Order_Details.ONUM
JOIN Product ON Order_Details.PNUM = Product.PNUM;
