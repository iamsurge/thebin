from QuikPy import QuikPy  # Работа с QUIK из Python через LUA скрипты QuikSharp

if __name__ == '__main__':  # Точка входа при запуске этого скрипта
    qpProvider = QuikPy()  # Вызываем конструктор QuikPy с подключением к локальному компьютеру с QUIK

    classCode = 'SPBOPT'  # Класс тикера
    secCode = 'Si60000BK2D'  # Тикер

    lastPrice = float(qpProvider.GetParamEx(classCode, secCode, 'LAST')['data']['param_value'])  # Последняя цена сделки
    bid = float(qpProvider.GetParamEx(classCode, secCode, 'BID')['data']['param_value'])  # Bid
    offer = float(qpProvider.GetParamEx(classCode, secCode, 'OFFER')['data']['param_value'])  # Ask
    print(f'{lastPrice=}, {bid=}, {offer=}')  # Работает и всё выводит

    ba = qpProvider.GetParamEx(classCode, secCode, 'OPTIONBASE')['data']['param_value']  # Базовый актив
    option_type = qpProvider.GetParamEx(classCode, secCode, 'OPTIONTYPE')['data']['param_value']
    long_name = qpProvider.GetParamEx(classCode, secCode, 'LONGNAME')['data']['param_value']  # Длинное имя
    print(f'{ba=}, {option_type=}, {long_name=}')  # Не работает, выводит '0.000000'

    # Выход
    qpProvider.CloseConnectionAndThread()  # Перед выходом закрываем соединение и поток QuikPy из любого экземпляра
