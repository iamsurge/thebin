#include <iostream>
#include <fstream>
#include <string>
#include <vector>
#include <cassert>

using namespace std;

struct Length
{
	int minutes;							// #minutes (0..)
	int seconds;							// #seconds (0..59)
};

struct Track
{
	string artist;                          // name of artist
	string cd;                              // cd title
	int    year;                            // year of appearance (if known)
	int    track;							// track number
	string title;                           // track title
	string tags;                            // tags
	Length time;							// playing time
	string country;                         // main countr(y/ies) of artist
};

struct TrackDisplay
{
	bool showArtist;						// if true, show name of artist
	bool showAlbum;							// if true, show cd title
	bool showYear;							// if true, show year of appearance
	bool showTrack;							// if true, show track number
	bool showTitle;							// if true, show track title
	bool showTags;                          // if true, show tags
	bool showLength;						// if true, show playing time
	bool showCountry;                       // if true, show countr(y/ies) of artist
};

bool match (string sub, string source)
{// Precondition:
    assert (true) ;
/*  Postcondition:
    Result is true only if sub is a literal (case sensitive) sub string of source.
*/
    return source.find(sub) != string::npos ;
}

ostream& operator<< (ostream& out, const Length length)
{// Precondition:
    assert (true) ;
/*  Postcondition:
    the value of length is shown via out in the format: minutes, ':', seconds (two digits)
*/
    if ( length.minutes < 10 )
    {
        out << '0' << length.minutes << ':';
    }
    else
    {
        out << length.minutes << ':';
    }
    if ( length.seconds < 10 )
    {
        out << '0' <<length.seconds;
    }
    else
    {
        out << length.seconds;
    }
    
    return out;
}

istream& operator>> (istream& in, Length& length)
{// Precondition:
    assert (true) ;
/*  Postcondition:
    the value of length has been read from in: first minutes, then ':', then seconds
*/
    in >> length.minutes >> length.seconds;
    return in;
}

Length operator+ (const Length& a, const Length& b)
{// Precondition:
    assert (0 <= a.minutes && 0 <= a.seconds && a.seconds < 60 && 0 <= b.minutes && 0 <= b.seconds && b.seconds < 60) ;
/*  Postcondition:
    Result is the sum of a and b.
*/
    int sum_of_minutes, sum_of_seconds;
    sum_of_minutes = a.minutes + b.minutes;
    sum_of_seconds = a.seconds + b.seconds;
    if ( sum_of_seconds >= 60 )
    {
        sum_of_minutes = sum_of_minutes + ( sum_of_seconds / 60 );
        sum_of_seconds = sum_of_seconds % 60;
    }
    return { sum_of_minutes, sum_of_seconds };
}

void show_track (Track track, TrackDisplay lt, ostream& os)
{// Precondition:
    assert (true) ;
/*  Postcondition:
    only the members of track are shown for which the corresponding member in lt is true.
*/
    if ( lt.showArtist )
    {
        os << track.artist;
    }
    if ( lt.showAlbum )
    {
        os << track.cd;
    }
    if ( lt.showYear )
    {
        os << track.year;
    }
    if ( lt.showTrack )
    {
        os<< track.track;
    }
    if ( lt.showTitle )
    {
        os << track.title;
    }
    if ( lt.showTags )
    {
        os << track.tags;
    }
    if ( lt.showLength )
    {
        os << track.time;
    }
    if ( lt.showCountry )
    {
        os << track.country;
    }
}

istream& operator>> (istream& in, Track& track)
{// Precondition:
    assert (true) ;
/*  Postcondition:
    the content of the first 8 lines from in have been read and are stored in the corresponding members of track.
    The following (empty) line from in has also been read.
*/
    in >> track.artist >> track.cd >> track.year >> track.track >> track.title >> track.tags >> track.time >> track.country;
    return in;
}

ostream& operator<< ( ostream& out, Track& track )
{
    out << track.artist << endl;
    out << track.cd << endl;
    out << track.year << endl;
    out << track.track << endl;
    out << track.title << endl;
    out << track.tags << endl;
    out << track.time << endl;
    out << track.country << endl;
    return out;
    
}
int match_tracks (const vector<Track>& tracks, string track, bool display)
{
    // implement this function
    int number_of_matches = 0;
    for ( unsigned int i = 0; i < tracks.size() ; i++ )
    {
        if ( match ( track, tracks.at (i).title ) )
        {
            number_of_matches++;
            if ( display == true )
            {
                TrackDisplay lt;
                lt.showArtist = true;
                lt.showAlbum = true;
                lt.showYear = true;
                lt.showTrack = true;
                lt.showTitle = true;
                lt.showTags = true;
                lt.showLength = true;
                lt.showCountry = true;
                show_track ( tracks.at (i),lt,cout );
            }
        }
    }
    return number_of_matches;
}

int match_artists (const vector<Track>& tracks, string artist, bool display)
{
    // implement this function
    int number_of_matches = 1;
    for ( unsigned int i = 0; i < tracks.size () - 1 ; i++)
    {
        if ( match ( artist, tracks.at (i).artist ) && (tracks.at (i).artist < tracks.at (i+1).artist) )
        {
            number_of_matches++;
            TrackDisplay lt;
            lt.showArtist = true;
            lt.showAlbum = false;
            lt.showYear = false;
            lt.showTrack = false;
            lt.showTitle = false;
            lt.showTags = false;
            lt.showLength = false;
            lt.showCountry = false;

            if ( display == true )
            {
                show_track ( tracks.at (i), lt, cout);
            }
        }
    }
    return number_of_matches;
}

int match_cds (const vector<Track>& tracks, string artist, bool display)
{
    // implement this function
    int number_of_matches = 1;
    for ( unsigned int i = 0; i < tracks.size () - 1 ; i++)
    {
        if ( match ( artist, tracks.at (i).artist ) && (tracks.at (i).cd < tracks.at (i+1).cd) )
        {
            number_of_matches++;
            TrackDisplay lt;
            lt.showArtist = true;
            lt.showAlbum = true;
            lt.showYear = true;
            lt.showTrack = false;
            lt.showTitle = false;
            lt.showTags = false;
            lt.showLength = false;
            lt.showCountry = false;

            if ( display == true )
            {
                show_track ( tracks.at (i), lt, cout);
            }
        }
    }
    return number_of_matches;
}

int number_of_cds (const vector<Track>& tracks)
{
    // implement this function
    string cds = "";
    int number_of_cds = 1;
    for ( unsigned int i = 0 ; i < tracks.size () - 1 ; i++ )
    {

        if ( tracks.at (i).cd < tracks.at (i+1).cd )
        {
            number_of_cds++;
        }

    }

    return number_of_cds;
}


int read_tracks (string filename, vector<Track>& tracks, bool show_content)
{// Precondition:
    assert (true);
/*  Postcondition:
    tracks is a copy of the tracks that are found in the file with file name filename, and result
    is the number of tracks that have been read.
    Only if show_content, then all read tracks are shown on screen.
*/
    ifstream f;
    f.open ( filename );
    if ( !f.fail () )
    {

        int positions = 0;
        Track track_file;
        while ( !f.eof () )
        {
            f >> track_file;
            tracks.at(positions)=track_file;
            
            if ( show_content == true )
            {
                cout << tracks.at (positions);
            }
            positions ++;
        }
        return positions;
    }
    return 0;
}

#ifndef TESTING
int main()
{// Precondition:
    assert (true) ;
/*  Postcondition:
    the music database "Tracks.txt" has been read (if present and correctly formatted).
    The assignment queries have been executed and their result has been shown on screen.
    In case of the bonus assignment, the user has been able to query the database and has
    seen the results of these queries.
*/
	return 0;
}
#endif