--[[
    Updater v1.0.0 by SimplyAzgoth
 
    Disclaimer: I am not the best coder.
 
    Script allows for CC:Tweaked computer's code to easily be updated from a local server.
    Requires you to enable local http servers in your CC:Tweaked configs. See https://tweaked.cc/guide/local_ips.html for help.
 
    Server should give a json list of json objects that contain the cc:tweaked filepath and the code you want to put.
    example below:
    [
        {
            "filePath": "tester.lua",
            "code": "print('Hello World!')"
        },
        {
            "filePath": "tester2.lua",
            "code": "print('Hello')\nprint('World!')"
        }
    ]
--]]


local URL = "http://127.0.0.1:5000"
local response = http.get(URL)

if response.getResponseCode() == 200 then 
    print("Successfully requested from: " .. URL)

    local json_list = textutils.unserialiseJSON(response.readAll())

    for _, json_obj in ipairs(json_list) do
        local file = fs.open(json_obj["filePath"], "w")
        file.write(json_obj["code"])
        file.close()
        print("Successfully written code to: " .. json_obj["filePath"])
    end

    print("Finished updating")
else
    print("GET request errored with code: " .. response.getResponseCode())
end