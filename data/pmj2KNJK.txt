import taichi as ti
from bisect import bisect

from taichi import random, floor

ti.init()


@ti.data_oriented
class A:
    def __init__(self, a):
        self.a = a
        self.n = len(a)

    @ti.func
    def sample(self):
        return min(self.n - 1, bisect(self.a, random()))

    @ti.func
    def get(self, idx):
        return self.a[self.sample()]


@ti.data_oriented
class B:
    def __init__(self):
        self.a = A([0.1, 0.4, 0.5, 1.0])

    @ti.kernel
    def run(self):
        print(self.a.get(self.a.sample()))


b = B()
b.run()
