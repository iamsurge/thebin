local doLog=true
local argv={...}
local pos={x=0,y=0,z=0,d=2} --relative (start facing "south")
local function log(message)
  if doLog then
    io.write("{")
    io.write(pos.x..",")
    io.write(pos.y..",")
    io.write(pos.z..";")
    io.write(pos.d.."}: ")
    io.write(message.."\n")
  end
end
local function turnTo(d,od)
  pos.d=od or pos.d
  local turnAction,dMod=turtle.turnRight,1
  if (d+1)%4 < d then
    turnAction,dMod=turtle.turnLeft,-1
  end
  while pos.d ~= d do
    turnAction()
    pos.d=(pos.d+dMod)%4
    if pos.d < 0 then pos.d=pos.d+4 end
  end
  return true
end
local function move0(moveAction,msgA,digAction,msgD)
  local s,e=digAction()
  log(msgD.."; ("..tostring(e)..")")
  s,e=moveAction()
  log(msgA.."; ("..tostring(e)..")")
  if not s then os.sleep(0.05) end
  return s,e
end
local function moveA(md,doRepeat)
  local s,e
  if md == 4 then      --down
    s,e=move0(turtle.down,"down",turtle.digDown,"digDown")
    while doRepeat and not s do
      s,e=move0(turtle.down,"down",turtle.digDown,"digDown")
    end
    return s,e
  elseif md == 5 then  --up
    s,e=move0(turtle.up,"up")
    while doRepeat and not s do
      s,e=move0(turtle.up,"up")
    end
    return s,e
  elseif pos.d==0 then --north (relative)
    log("north ()")
  elseif pos.d==1 then --east (relative)
  elseif pos.d==2 then --south (relative)
  elseif pos.d==3 then --west (relative)
  
  end
end
moveA(5)