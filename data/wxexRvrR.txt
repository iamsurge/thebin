lines = []
with open("10_input.txt", "r") as infile:
    for line in infile.readlines():
        lines.append(line.strip("\r\n"))

target_cycles = set([20, 60, 100, 140, 180, 220])
total_strength = 0
x = 1
current_cycle = 0
cycles_remaining = 0
processing_value = 0

while lines:
    current_cycle += 1
    #START
    if cycles_remaining == 0: # If we're not still executing an instruction, start a new one.
        if lines: # ...At least, if we still have more instructions to execute.
            new_instr = lines.pop(0).split(" ")
            if new_instr[0] == "noop":
                cycles_remaining = 1
                processing_value = 0
            elif new_instr[0] == "addx":
                cycles_remaining = 2
                processing_value = int(new_instr[1])
    #DURING
    print("CYCLE "+str(current_cycle)+": x = "+str(x), end="")
    if current_cycle in target_cycles:
        print(" <-- TARGET, str="+str(current_cycle * x))
        total_strength += current_cycle * x
    else:
        print()
    #END
    cycles_remaining -= 1
    if cycles_remaining == 0: # An instruction has finished processing.
        x += processing_value
print("Program finished. Total strength = "+str(total_strength))