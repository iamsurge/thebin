using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;

namespace FileProtection
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            if (openFileDialog1.ShowDialog() == DialogResult.OK)
            {
                String[] list = openFileDialog1.FileNames;
                bool r = true;
                int i = 0;
                while (r == true)
                {
                    try
                    {
                        listBox1.Items.Add((listBox1.Items.Count + 1) + "¯" + list[i]);
                        i++;
                        log("File Added!");
                    }
                    catch (Exception ex) { r = false; }
                }
            }
        }
        public void log(string log)
        {
            logtx.Text = log + Environment.NewLine + logtx.Text;
        }
        private void button2_Click(object sender, EventArgs e)
        {
            listBox1.Items.Remove(listBox1.SelectedItem);
            log("File Removed!");
        }
        public Byte[] f1;
        public Byte[] f2;
        public Byte[] f3;
        public Byte[] f4;
        public Byte[] f5;
        public Byte[] f6;
        public Byte[] f7;
        public Byte[] f8;
        public Byte[] f9;
        public Byte[] f10;
        public Byte[] f11;
        public Byte[] f12;
        public Byte[] f13;
        public Byte[] f14;
        public Byte[] f15;
        public Byte[] f16;
        public Byte[] f17;
        public Byte[] f18;
        public Byte[] f19;
        public Byte[] f20;
        private void timer1_Tick(object sender, EventArgs e)
        {
            label2.Text = "Last Backup : " + DateTime.Now.Hour + ":" + DateTime.Now.Minute + ":" + DateTime.Now.Second;
            String[] list = { "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "" };
            bool r = true;
            int i = 0;
            while (r == true)
            {
                try
                {
                    list[i] = Convert.ToString(listBox1.Items[i]).Split('¯')[1];
                    i++;
                }
                catch (Exception ex) { r = false; }
            }
            int id = 0;
            /////////////////////
            try
            {
                
                id = 0;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f10 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f10);
                    log("Fix Complete");
                }
                id = 1;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f1 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f1);
                    log("Fix Complete");
                }
                id = 2;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f2 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id +" Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f2);
                    log("Fix Complete");
                }
                id = 3;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f3 = File.ReadAllBytes(list[id]);

                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f3);
                    log("Fix Complete");
                }
                id = 4;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f4 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f4);
                    log("Fix Complete");
                }
                id = 5;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f5 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f5);
                    log("Fix Complete");
                }
                id = 6;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f6 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f6);
                    log("Fix Complete");
                }
                id = 7;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f7 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    File.WriteAllBytes(list[id], f7);
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    log("Fix Complete");
                }
                id = 8;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f8 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f8);
                    log("Fix Complete");
                }
                id = 9;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f9 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f9);
                    log("Fix Complete");
                }
                id = 10;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f20 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f20);;
                    log("Fix Complete");
                }
                id = 11;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f11 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f11);
                    log("Fix Complete");
                }
                id = 12;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f12 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f12);
                    log("Fix Complete");
                }
                id = 13;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f13 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f13);
                    log("Fix Complete");
                }
                id = 14;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f14 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f14);
                    log("Fix Complete");
                } id = 15;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f15 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f15);
                    log("Fix Complete");
                }
                id = 16;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f16 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f16);
                    log("Fix Complete");
                }
                id = 17;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f17 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f17);
                    log("Fix Complete");
                }
                id = 18;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f18 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f18);
                    log("Fix Complete");
                }
                id = 19;
                listBox1.Items[id].ToString();
                if (File.Exists(list[id]))
                {
                    if (listBox1.GetItemChecked(id) == false)
                    {
                        f19 = File.ReadAllBytes(list[id]);
                    }
                    else if (checkBox1.Checked == true)
                    {
                        if ((File.GetLastWriteTime(list[id]).Second + 2) > DateTime.Now.Second)
                        {
                            log("File " + id + " Change!");
                            log("Deleting For Fix");
                            File.Delete(list[id]);
                        }
                    }
                }
                else
                {
                    log("File " + Convert.ToString(id + 1) + " Deleted!");
                    File.WriteAllBytes(list[id], f19);
                    log("Fix Complete");
                }
                
            }
            catch (Exception ex) { }
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            label5.Text = "License For " + Properties.Settings.Default.Username;
            timer1.Start();
        }

        private void label3_Click(object sender, EventArgs e)
        {
            MessageBox.Show("Use For File You Don't Want To Edit \n But Need To Protect From Delete", "INFO");
        }
    }
}