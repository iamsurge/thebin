-- Задание 1
CREATE VIEW Highrating AS
SELECT CNAME, CITY, RATING
FROM Customers
WHERE RATING IN (SELECT MAX(RATING) FROM Customers);

-- Задание 2
CREATE VIEW Multsalespeople
AS SELECT SNAME, CITY, COMM
FROM Salespeople
WHERE SNUM IN (SELECT SNUM
				FROM Orders
				GROUP BY SNUM
				HAVING COUNT(SNUM) > 1);

-- Задание 3
CREATE VIEW Multcustomers AS
SELECT SNAME as 'Имя продавца',
		Salespeople.CITY as 'Город продавца',
		COMM, CNAME as 'Имя покупателя',
		Customers.CITY as 'Город покупателя',
		RATING as 'Рейтинг покупателя'
FROM Customers JOIN Salespeople
ON Customers.SNUM = Salespeople.SNUM;

-- Задание 4
CREATE VIEW Citynumber AS
SELECT CITY, COUNT(CITY) as 'Количество продавцов'
FROM Salespeople
GROUP BY CITY;

-- Задание 5
CREATE VIEW Commissions AS
SELECT SNUM, COMM
FROM Salespeople
WHERE COMM BETWEEN 0.10 AND 0.13;

-- Задание 6
CREATE VIEW NotProd AS
SELECT PNAME, PRICE
FROM Product
WHERE PNUM NOT IN (SELECT PNUM FROM Order_Details);