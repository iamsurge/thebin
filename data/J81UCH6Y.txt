WITH temple AS (SELECT DATE_TRUNC('month', created_at::date),
                COUNT(user_id) OVER (PARTITION BY DATE_TRUNC('month', created_at::date))
FROM tools_shop.users),

shrine AS (SELECT DISTINCT(date_trunc)::date AS month, count
           FROM temple),

pagoda AS (SELECT month,
               SUM(count) OVER (ORDER BY month) AS overall
               FROM shrine)

SELECT month, overall
FROM pagoda
ORDER BY month DESC