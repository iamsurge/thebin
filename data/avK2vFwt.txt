
select
    query_id,
    substr(query_text, 1, 50) partial_query_text,
    user_name,
    warehouse_name,
    warehouse_size, 
    BYTES_SPILLED_TO_{REMOTE/LOCAL}_STORAGE, 
    start_time, 
from  snowflake.account_usage.query_history
where BYTES_SPILLED_TO_{REMOTE/LOCAL}_STORAGE > 0
and start_time::date > dateadd('month', -3, current_date)
order by BYTES_SPILLED_TO_{REMOTE/LOCAL}_STORAGE desc
limit 10
;