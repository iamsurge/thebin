SELECT
	(CASE 
	WHEN paymentDateTime > '2022-07-13 00:00:01' THEN 'AfterDeploy'
	WHEN paymentDateTime < '2022-07-11 23:59:59' THEN 'BeforeDeploy'
	ELSE 'DeployDay'
	END) as beforeAfterDeploy,
	count(DISTINCT userID) userCount,
	ROUND(SUM(paymentAmount)) revenue
	
FROM
	`uptimerobot-001.ur.payments` p
	
WHERE 
/*Put the number of days after the deploy. Use the max. number of days until the reporting day -1 from the deploy date*/

DATETIME(paymentDateTime) > DATE_SUB('2022-07-11', INTERVAL 102 DAY) 
AND DATETIME(paymentDateTime) < DATE_ADD('2022-07-13', INTERVAL 102 DAY)


AND paymentPeriod = 0

GROUP BY
	beforeAfterDeploy
