
package com.mycompany.javacomsql;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Date;

/**
 *
 * @author user
 */
public class Movimento {
    private int codMovimento;
    private int codCategoria;
    private String descricao;
    private Date data = new Date();
    private String local;
    private double valor;

    public int getCodMovimento() {
        return codMovimento;
    }

    public void setCodMovimento(int codMovimento) {
        this.codMovimento = codMovimento;
    }

    public int getCodCategoria() {
        return codCategoria;
    }

    public void setCodCategoria(int codCategoria) {
        this.codCategoria = codCategoria;
    }

    public String getDescricao() {
        return descricao;
    }

    public void setDescricao(String descricao) {
        this.descricao = descricao;
    }

    public Date getData() {
        return data;
    }

    public void setData(Date data) {
        this.data = data;
    }

    public String getLocal() {
        return local;
    }

    public void setLocal(String local) {
        this.local = local;
    }

    public double getValor() {
        return valor;
    }

    public void setValor(double valor) {
        this.valor = valor;
    }
    
    
    public void listar() {

        Conexao conexao = new Conexao();
        Connection conn = conexao.conectar();

        try {
            String sql = "SELECT m.codMovimento,m.codCategoria,m.descricao,m.data,m.local,m.valor, c.categoria FROM `movimentos` m INNER join categoria c on c.codCategoria = m.codCategoria;";

            Statement stmt = conn.createStatement();

            ResultSet rs = stmt.executeQuery(sql);
            
            while (rs.next()) {
               int codMovimento = rs.getInt("codMovimento");
                int codigoCategoria = rs.getInt("codCategoria");
                String descricao = rs.getString("descricao");
                String categoria = rs.getString("categoria");
                Date data  = rs.getDate("data");
                String local = rs.getString("local");
                Double valor = rs.getDouble("valor");
                System.out.println("Movimento: "+ codMovimento +" Categoria: " + codigoCategoria + " - " + categoria  + " Descrição: " + descricao + " Data: " + data + " Local: "+ local + " Valor: "+ valor);

            }
            stmt.close();
            conexao.desconectar(conn);
        } catch (SQLException ex) {
            System.out.println("Erro " + ex);
        }
    }
  
    public void inserir() {

        Conexao conexao = new Conexao();
        Connection conn = conexao.conectar();

        try {
            String sql = "INSERT INTO 'movimentos' ('codMovimento', 'codCategoria', 'descricao', 'data', 'local', 'valor') VALUES"+
                    "(NULL, '"+this.codCategoria+"', '"+this.descricao+"', '"+this.data+"', '"+this.local+"', '"+this.valor+"')";

            Statement stmt = conn.createStatement();

            ResultSet rs = stmt.executeQuery(sql);

            stmt.close();
            conexao.desconectar(conn);

        } catch (SQLException ex) {
            System.out.println("Erro " + ex);
        }

    }
    
    public void excluir() {

        Conexao conexao = new Conexao();
        Connection conn = conexao.conectar();
        

        try {
            String sql = "Delete from `movimentos`  WHERE `codMovimento`.`codMovimento` = "+this.codMovimento;

            Statement stmt = conn.createStatement();

            ResultSet rs = stmt.executeQuery(sql);

            stmt.close();
            conexao.desconectar(conn);
            

        } catch (SQLException ex) {
            System.out.println("Erro " + ex);
        }

    }
    
    
    public void alterar() {

        Conexao conexao = new Conexao();
        Connection conn = conexao.conectar();
        

        try {
            String sql = "UPDATE 'movimentos' SET "
                    + "'codCategoria' = '"+this.codCategoria+"', 'descricao' = '"+this.descricao+"', "
                    + "'data' = '"+this.data+"', 'local' = '"+this.local+"', "
                    + "'valor' = '"+this.valor+"' WHERE 'movimentos'.'codMovimento' = "+this.codMovimento+"";

            Statement stmt = conn.createStatement();

            ResultSet rs = stmt.executeQuery(sql);

            stmt.close();
            conexao.desconectar(conn);
            

        } catch (SQLException ex) {
            System.out.println("Erro " + ex);
        }

    }
}