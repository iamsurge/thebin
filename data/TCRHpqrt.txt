import csv
header_list = ['author', 'album', 'year', 'genre', 'time']


def import_data(filename='albums_data.txt'):
    with open(filename, newline='') as file:
        reader = csv.reader(file, delimiter=',')
        data = list(reader)
        return data


def export_data(albums, filename='albums_data.txt', mode='a'):
    if 'a' != mode != 'w':
        raise ValueError()

    with open(filename, mode, newline='') as file:
        writer = csv.writer(file)
        for album_index, album in enumerate(albums):
            writer.writerow(album)
    return file


def get_albums_by_genre(albums, genre):
    genre_index = 0
    for header_id, header in enumerate(header_list):
        if header == 'genre':
            genre_index = header_id
    albums_by_genre = []
    for album in albums:
        if album[genre_index] == genre:
            albums_by_genre.append(album)
    return albums_by_genre


def get_genre_stats(albums):
    genre_index = 0
    for header_id, header in enumerate(header_list):
        if header == 'genre':
            genre_index = header_id

    genres = set()

    for album in albums:
        genres.add(album[genre_index])

    out_dict = dict.fromkeys(genres, 0)

    for genre_id, genre in enumerate(genres):
        albums_in_this_genre = get_albums_by_genre(albums, genre)
        for nr_of_albums in albums_in_this_genre:
            out_dict[genre] += 1
    return out_dict


def get_last_oldest_of_genre(albums, genre):
    all_in_genre = get_albums_by_genre(albums, genre)
    year_index = 0
    for header_id, header in enumerate(header_list):
        if header == 'year':
            year_index = header_id
    year_nr = 0
    oldest_year = 3000
    for album_index, album in enumerate(all_in_genre):
        if int(album[year_index]) < oldest_year:
            oldest_year = int(album[year_index])
            year_nr = album_index
    return all_in_genre[year_nr]


if __name__ == '__main__':
    albums_data = import_data()
    print(get_last_oldest_of_genre(albums_data, 'rock'))
