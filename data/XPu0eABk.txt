rednet.open(peripheral.getName(peripheral.find('modem')))

term.setCursorPos(1,1)
term.clear()

local r = false

io.write('screen: ')
local screen = io.read()

while true do

    local flags = {}

    io.write('frequency: ')
    local channelid = io.read()
    local channel = 'cctv:'..channelid

    r = false

    if #screen >0 then
        term.redirect(peripheral.find(screen) or peripheral.wrap(screen));
        (peripheral.find(screen) or peripheral.wrap(screen) or {setTextScale=function()end}).setTextScale(0.5)
    end

    while true do

        local to = 5
        if not r then
            to = 1
        end
        
        local sender, message = rednet.receive(channel,to)

        if sender == nil then
            term.clear()
            term.setCursorPos(1,1)
            term.setTextColor(colors.red)
            term.redirect(term.native())
            if r then
                print('Signal lost')
            else
                print('No signal')
            end
            term.setTextColor(colors.white)
            break
        end

        paintutils.drawImage(message,1,1)
        term.setBackgroundColor(colors.black)
        term.setTextColor(colors.white)

        r = true

    end

end