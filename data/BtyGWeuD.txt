<div id="txt">Lorem Ipsum</div>
<br />
<button id="test">Download text as file !</button>

<script type="text/javascript">
var client = new XMLHttpRequest();
var sna_contents;

client.open('GET', 'fb_year_test.sna',true);
client.responseType = "arraybuffer";
client.onreadystatechange = function() {
  //alert(client.responseText);
  //console.log(client.responseText);
  console.log(client.response);
  //sna_contents=client.responseText;
  sna_contents=client.response;
  //var byteSize = //sna_contents => new Blob([sna_contents]).size;
  var byteSize = new Blob([client.response]).size;
  //var byteSize = new Blob([sna_contents]).size;
  console.log("bytesize===="+byteSize);
}
client.send();

/*
const req = new XMLHttpRequest();
req.open("GET", "fb_year_test.sna", true);
req.responseType = "arraybuffer";

req.onload = (event) => {
  const arrayBuffer = req.response; // Note: not req.responseText
  if (arrayBuffer) {
    const byteArray = new Uint8Array(arrayBuffer);
    console.log(byteArray.join());
    byteArray.forEach((element, index) => {
      // do something with each byte in the array
    });
  }
};

req.send(null);
*/
//sna_contents="";



function download_txt() {
  //var textToSave = document.getElementById('txt').innerHTML;
  var textToSave=new sna_contents;
  var hiddenElement = document.createElement('a');

//  hiddenElement.href = 'data:attachment/text,' + encodeURI(textToSave);
  hiddenElement.href = 'data:attachment/text,' + encodeURI(textToSave);
  console.log(textToSave);
  hiddenElement.target = '_blank';
  hiddenElement.download = 'myFile.sna';
  hiddenElement.click();
}

document.getElementById('test').addEventListener('click', download_txt);

</script>

