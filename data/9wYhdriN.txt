#! /bin/bash
# $PROG: dradio
# dependency : dmenu , mpv
# debian-base OS : sudo apt update && sudo apt upgrade -y ; sudo apt install mpv dmenu 
# if not installed in system

url="https://pastebin.com/raw/unEZwgP0" # radiolist online

choice=$(curl -s "$url" | tr -d '\r' | cut -d" " -f1 | \
         dmenu -i -l 20 -b -fn 'Mono:bold:pixelsize=15') #radio stations menu

# set IFS separator 
OIFS=$IFS 
IFS='
'

while read -r line ; do
        if echo "$line" | grep "$choice" ; then
                IFS=$OIFS #set IFS back to default
                m3u=$(echo "$line" | cut -d" " -f2)
                if [[ "$m3u" =~ exit ]] ; then 
                        break
                else
                        mpv --no-audio-display "$m3u"
                fi
                break
        fi
done <<<$(curl -s "$url" | tr -d '\r')

exit 0