
dati=Dati.questionario.regressione

library(scatterplot3d)
pairs(data.frame(dati$C.2.Quanto.spesso.acquisti.capi.d.abbigliamento.firmati.,dati$B.4.Qual.è.il.tuo.reddito.+dati$B.1.Genere))

cor(dati$C.2.Quanto.spesso.acquisti.capi.d.abbigliamento.firmati.,dati$d_donna,use="complete.obs") #mat i corr
cor(dati$C.2.Quanto.spesso.acquisti.capi.d.abbigliamento.firmati.,dati$d_uomo,use="complete.obs") #mat i corr
cor(dati$C.2.Quanto.spesso.acquisti.capi.d.abbigliamento.firmati.,dati$d_lavoratore,use="complete.obs") #mat i corr
cor(dati$C.2.Quanto.spesso.acquisti.capi.d.abbigliamento.firmati.,dati$d_discoccupato,use="complete.obs") #mat i corr
cor(dati$C.2.Quanto.spesso.acquisti.capi.d.abbigliamento.firmati.,dati$d_studente,use="complete.obs") #mat i corr
cor(dati$C.2.Quanto.spesso.acquisti.capi.d.abbigliamento.firmati.,dati$d_red1,use="complete.obs") #mat i corr
cor(dati$C.2.Quanto.spesso.acquisti.capi.d.abbigliamento.firmati.,dati$d_red2,use="complete.obs") #mat i corr
cor(dati$C.2.Quanto.spesso.acquisti.capi.d.abbigliamento.firmati.,dati$d_red3,use="complete.obs") #mat i corr
cor(dati$C.2.Quanto.spesso.acquisti.capi.d.abbigliamento.firmati.,dati$d_red4,use="complete.obs") #mat i corr
cor(dati$C.2.Quanto.spesso.acquisti.capi.d.abbigliamento.firmati.,dati$d_red5,use="complete.obs") #mat i corr

reg=lm(dati$C.2.Quanto.spesso.acquisti.capi.d.abbigliamento.firmati.~dati$d_donna+dati$d_uomo+dati$d_discoccupato+dati$d_lavoratore+dati$d_studente+dati$d_red1+dati$d_red2+dati$d_red3+dati$d_red4+dati$d_red5)
summary(reg)

reg$coef
res=reg$residuals
res #vediamo i residui

#t test: serve a testare che la media dei residui sia pari zero
#se p-value >0.05 allora i residui vanno bene
t.test(res)
library(lmtest)
#test per l'omoschedasticità dei residui
#TEST DI BREUSCH-PAGAN
#sse pvalue >0.05 i residui sono omoschedastici (tutti i dati + importanti
# hanno varianza costante)-vanno bene 
bptest(reg,data=dati)
#test di DURBIN-WATSON:per testare l'autocorrelazione dei residui
#se p-value>0.05 i residui non sono autocorrelati-vanno bene
dwtest(reg,data=dati)

y_fit=fitted(reg)	
y_fit
#Visualizzare che i residui si muovano intorno allo zero
plot(y_fit,	res,	ylab="Residui",	xlab="Fitted",	main="Residui	vs fitted")	
abline(h=0)


#Normalità distributiva dei residui
qqnorm(scale(res))
abline(0,1)

#multicollinearità
#se ci sono variabili con un VIF score >5 vanno eliminate
library(car)
vif(reg)

