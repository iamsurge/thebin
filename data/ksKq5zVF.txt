using System;
using System.Collections.Generic;
using System.Linq;
using System.Security.Cryptography.X509Certificates;

namespace _02._Book_s_World
{
    internal class Program
    {
        static void Main(string[] args)
        {
            List<string> bookGenres = Console.ReadLine().Split(" | ", StringSplitOptions.RemoveEmptyEntries).ToList();

            string command = Console.ReadLine();
            while (command != "Stop!")
            {
                string[] commandArgs = command.Split(" ", StringSplitOptions.RemoveEmptyEntries).ToArray();
                if (commandArgs.Length == 2)
                {
                    string action = commandArgs[0];
                    string genre = commandArgs[1];
                    if (action == "Join")
                    {
                        if (bookGenres.Contains(genre))
                        {
                            break;
                        }
                        bookGenres.Add(commandArgs[1]);
                    }
                    else if (action == "Drop")
                    {
                        if (bookGenres.Contains(genre))
                        {
                            bookGenres.Remove(genre);
                        }
                        //else
                        //{
                        //    break;
                        //}
                    }
                }
                else if (commandArgs.Length == 3)
                {
                    if (commandArgs[0] == "Replace")
                    {
                        string oldGenre = commandArgs[1];
                        string newGenre = commandArgs[2];
                        if (bookGenres.Contains(oldGenre) && (!bookGenres.Contains(newGenre)))
                        {
                            int indexOfOldBook = bookGenres.IndexOf(oldGenre);
                            bookGenres.RemoveAt(indexOfOldBook);
                            bookGenres.Insert(indexOfOldBook, newGenre);
                        }
                    }
                    else if (commandArgs[0] == "Prefer")
                    {
                        int index1 = int.Parse(commandArgs[1]);
                        int index2 = int.Parse(commandArgs[2]);
                        if (bookGenres.Count > index1 && bookGenres.Count > 2 && bookGenres.ElementAtOrDefault(index1) != null && bookGenres.ElementAtOrDefault(index2) != null)
                        {
                            string temporary = bookGenres.ElementAtOrDefault(index1); //book at index1
                            string temporary2 =bookGenres.ElementAtOrDefault(index2); //book at index2
                            bookGenres[index2] = temporary;
                            bookGenres[index1] = temporary2;
                        }

                    }
                }
                command = Console.ReadLine();
            
            }
            Console.WriteLine(string.Join(" ", bookGenres));
        }
    }
}
