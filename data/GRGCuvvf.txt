module.exports = async (input, callback, error) => {
    try {
        let request = input.request;

        switch (request.url) {
            case "https://graph.microsoft.com/addAlias":
                request.body.operation = "ADD_EMAIL_ALIAS";
                break;
            case "https://graph.microsoft.com/removeAlias":
                request.body.operation = "REMOVE_EMAIL_ALIAS";
                break;
            case "https://graph.microsoft.com/convertMailboxToShared":
                request.body.operation = "CONVERT_MAILBOX_TO_SHARED";
                break;
            case "https://graph.microsoft.com/addToDistributionGroup":
                request.body.operation = "ADD_TO_DISTRIBUTION_GROUP";
                break;
            case "https://graph.microsoft.com/removeUserFromDistributionGroup":
                request.body.operation = "REMOVE_FROM_DISTRIBUTION_GROUP";
                break;
            case "https://graph.microsoft.com/hideFromGAL":
                request.body.operation = "HIDE_FROM_GLOBAL_ADDRESS_LIST";
                break;
            case "https://graph.microsoft.com/authCheck":
                request.body.operation = "AUTH_CHECK";
                break;
            default:
                error("Unable to find operation type. URL case not recognized.")
        }

        request.url = input.secrets.RunbookURL;

        callback(input.request);
    } catch (err) {
        error(err)
    }
};