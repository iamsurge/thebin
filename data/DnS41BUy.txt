---
- name: Проверка доступности хостов по порту
  loop: "{{ kafka }}"
  wait_for:
    host: "{{ item }}"
    port: 9092
    state: started
    delay: 0
    timeout: 1

- name: check if 192.168.33.12:25 is accessible
  wait_for:
    host: 192.168.33.12
    port: 25
    state: started
    delay: 0
    timeout: 1
    search_regex: Postfix

- name: Проверка доступности хостов
  wait_for:
    host: mywebserver.com
    port: "{{ item }}"
    state: started         # Port should be open
    delay: 0               # No wait before first check (sec)
    timeout: 3             # Stop checking after timeout (sec)
  ignore_errors: yes
  with_items:
    - 443
    - 80
    - 80443