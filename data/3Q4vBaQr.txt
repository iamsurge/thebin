version: "3.9"

services:

  mongodb:
    environment:
      - MONGODB_ROOT_PASSWORD=MyMongoPassword
      - MONGODB_USERNAME=nightscout
      - MONGODB_PASSWORD=MyMongoPassword
      - MONGODB_DATABASE=nightscout
	  #https://www.google.com/search?q=how+to+find+uid+gid+in+linux
      - PUID=1000
      - PGID=100
      - TZ=America/Detroit      
    image: docker.io/bitnami/mongodb:4.4
    ports:
      - "27017:27017"
    volumes:
	#before the colon is your local folder that you want to store your data
      - /srv/dev-disk-by-label-KINGSTON120gb/AppData/nightscout_mongo2:/bitnami/mongodb
    
  mongo-express:
    depends_on:
      - mongodb
    environment:
      - ME_CONFIG_MONGODB_ADMINUSERNAME=root
      - ME_CONFIG_MONGODB_ADMINPASSWORD=MyMongoPassword
      - ME_CONFIG_MONGODB_URL=mongodb://root:MyMongoPassword@mongodb:27017/
    image: mongo-express
    ports:
      - 8081:8081
    # restart: always

  # docker-compose run --service-ports app /bin/bash
  app:
    depends_on:
      - mongodb
    environment:
      - API_SECRET=MySecretAPI
      - MONGODB_URI=mongodb://nightscout:MyMongoPassword@mongodb:27017/nightscout
      - HOSTNAME=0.0.0.0
      - INSECURE_USE_HTTP=true
      - PUID=1000
      - PGID=100
      - TZ=America/Detroit
    image: nightscout/cgm-remote-monitor
    ports:
      - "1337:1337"