function kt_hide_out_of_stock_option( $option ){
    return 'yes';
}
 
add_action( 'woocommerce_before_template_part', function( $template_name ) {
 
    if( $template_name !== "single-product/related.php" ) {
        return;
    }
 
    add_filter( 'pre_option_woocommerce_hide_out_of_stock_items', 'kt_hide_out_of_stock_option' );
 
} );
 
add_action( 'woocommerce_after_template_part', function( $template_name ) {
 
    if( $template_name !== "single-product/related.php" ) {
        return;
    }
 
    remove_filter( 'pre_option_woocommerce_hide_out_of_stock_items', 'kt_hide_out_of_stock_option' );
 
} );