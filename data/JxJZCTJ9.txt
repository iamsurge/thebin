// consumer.c
#include <stdio.h>
#include <shared.h>

int main() {
        char *counter;
        counter = (char *) getmem(2062150888);
        sem_t sem, sem_empty, sem_full;

        // Init
        sem = sem_init(2601);
        sem_empty = sem_init(2602);
        sem_full = sem_init(2603);

        for(char c = 'a'; c <= 'z'; c++) {
                PS(sem_full);
                PS(sem);

                *counter = c;

                VS(sem);
                VS(sem_empty);

                printf("The char is: %c \n", *counter);
        }

        return 0;
}

// producer.c
#include <stdio.h>
#include <shared.h>

int main() {
        char *counter, c;
        counter = (char *) getmem(2062150888);
        sem_t sem, sem_empty, sem_full;

        // init
        sem = sem_init(2601);
        sem_empty = sem_init(2602);
        sem_full = sem_init(2603);

        for(c = 'a'; c <= 'z'; c++) {
                PS(sem_empty);
                PS(sem);

                *counter = c;

                VS(sem);
                VS(sem_full);
        }
        printf("The producer has ended. \n");
}


// init.c

#include <stdio.h>
#include <shared.h>

int main() {
        char *counter;
        counter = (int *)getmem(2062150888);
        sem_t sem, sem_empty, sem_full;

        // init
        sem = sem_init(2601);
        sem_empty = sem_init(2602);
        sem_full = sem_init(2603);

        // set
        sem_set(sem, 1);
        sem_set(sem_empty, 1);
        sem_set(sem_full, 0);

        *counter = 0;

        return 0;
}

// show.c

#include <stdio.h>
#include <shared.h>

int main() {
        char *counter;
        counter = (int *)getmem(2062150888);
        sem_t sem, sem_empty, sem_full;

        // init
        sem = sem_init(2601);
        sem_empty = sem_init(2602);
        sem_full = sem_init(2603);

        sem_remove(sem);
        return 0;
}

// run.sh
#! bin/bash

gcc -O0 -o init init.c -lshared
gcc -O0 -o producer producer.c -lshared
gcc -O0 -o consumer consumer.c -lshared
gcc -O0 -o show show.c -lshared

./init

./producer &
./consumer &
