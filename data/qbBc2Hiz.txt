var idRegex = /^[0-9]+$/;

function calculateEMI(installmentAmount, totalTax, noOfEMIs) {
	return Math.round(installmentAmount + (totalTax / noOfEMIs));
}

(function init() {
	const table = document.querySelector("table[summary='Amortization Schedule']");

	if (table) {
		let interest = 0;
		let installmentAmount = -1;
		let noOfEMIs = 0;
		for (const row of table.querySelectorAll("tr")) {
			if (idRegex.test(row.id) && row.children[4]) {
				if (installmentAmount === -1) {
					installmentAmount = Number(row.children[5].innerText);
				}

				interest += Number(row.children[4].innerText);
				noOfEMIs += 1;
			}
		}

		interest = Number(interest.toFixed(1));
		let tax = interest * 18 / 100;

		let emi = calculateEMI(installmentAmount, tax, noOfEMIs);

		console.log({
			installmentAmount,
			noOfEMIs,
			interest,
			tax,
			emi
		})
	}
})()