width = 8
depth = 8

count = 1

function setup()
    slot1 = turtle.getItemDetail(1)
    if slot1.name == "minecraft:dirt" then
        turtle.select(1)
        for i=1,width do
            for j=1,depth do
                turtle.digDown()
                turtle.placeDown()
                if j < depth then turtle.forward() end
            end
            if (i % 2 == 0) then
                turtle.turnRight()
                turtle.forward()
                turtle.turnRight()
            else
                turtle.turnLeft()
                turtle.forward()
                turtle.turnLeft()
            end        
        end
        turtle.turnRight()
        for i=1,8 do turtle.forward() end
        turtle.turnLeft()
    end
end

--setup()

function harvestAndPlant()
    turtle.select(1)
    for i=1,width do
        for j=1,depth do
            turtle.digDown()
            turtle.placeDown()
            if j < depth then turtle.forward() end
        end
        if (i % 2 == 0) then
            turtle.turnRight()
            turtle.forward()
            turtle.turnRight()
        else
            turtle.turnLeft()
            turtle.forward()
            turtle.turnLeft()
        end        
    end
    turtle.turnRight()
    for i=1,8 do turtle.forward() end
    turtle.turnLeft()
end

function deposit()
    print("dumping load: " .. count)
    count = count + 1
    turtle.turnLeft()
    turtle.turnLeft()
    for i=2,16 do
        turtle.select(i)
        turtle.drop()
    end
    turtle.turnLeft()
    turtle.turnLeft()
end   

_, detail = turtle.inspectDown()
while true do
    if detail.state.age == 7 then
        harvestAndPlant()
        deposit()
    end
    sleep(60)
end
