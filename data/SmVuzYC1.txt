# Открываем камеру
# Здесь "1" - порядковый номер нашей камеры в системе
video_file = cv2.VideoCapture(1)
# Проверяем, открыт ли еще видеофайл
while video_file.isOpened():
	# Получаем следующий кадр в переменную frame,
	# а признак выполненного чтения - во flag
	flag, frame = video_file.read()
	if not flag:
		continue        
	# Пытаемся распознать объекты в кадре
	# Если удалось распознать, то получаем их обводку (bbox), 
	# а также коэффициент уверенности (conf)
	# Имена распознанных объектов запишутся в переменную labels
	try:
        bbox, labels, conf = cvlib.detect_common_objects(frame,
                                                         model=yolo4-tiny,
                                                         confidence=0.75,
                                                         enable_gpu=true)
	# Если не получилось распознать - выводим сообщением об ошибке
    except Exception as e:
        print(e)
        break
	# Если в именах распознанных объектов есть человек (хранится как 'person'),
	# то рисуем на кадре frame прямоугольник вокруг человека,
	# а также коэффициент уверенности сверху него
	if 'person' in labels:
            frame = cvlib.object_detection.draw_bbox(frame,
                                                     bbox,
                                                     labels,
                                                     conf)
	# Отображаем кадр в окне с названием 'Room'
	cv2.imshow("Room", frame)
	# Ждем 25 миллисекунд перед началось обработки следующего кадра
	cv2.waitKey(25)