from csv import reader
from re import sub


def print_final_processed(current_dictionary: dict) -> None:
    for column_name, column_intersection in current_dictionary.items():
        processed_intersection = ', '.join(column_intersection)
        processed_intersection = sub(r'\s+', ' ', processed_intersection)
        print(f'{column_name}: {processed_intersection}')
    print()


def get_clean_string(current_string: str) -> str:
    return sub(r'\<[^>]*\>', '', current_string).strip()


csv_file = open(input(), encoding='utf_8_sig')
csv_reader, all_data_list = reader(csv_file), list()

for current_data in csv_reader:
    all_data_list.append(current_data)

columns, all_data = all_data_list[0], all_data_list[1:]
first_result, second_result = list(), list()

for current_data in all_data:
    if len(current_data) == len(columns) and \
            not current_data.__contains__(''):
        first_result.append(current_data)

for string in first_result:
    dictionary, counter = dict(), 0
    for word in string:
        dictionary[columns[counter]] = get_clean_string(word).split('\n')
        counter += 1
    second_result.append(dictionary)

for string in second_result:
    print_final_processed(string)
