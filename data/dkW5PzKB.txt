/* Составьте запрос, который выводит номер и фамилию каждого покупателя вместе с фамилией и городом продавца, прикрепленного к покупателю. 
Предложите два варианта такого запроса: без использования и с использованием специального оператора соединения JOIN.

Без использования специального оператора соединения JOIN: */
Select Customers.cnum, Customers.cname, Salespeople.sname, Salespeople.city 
from Salespeople, Customers
Where Salespeople.snum = Customers.snum;
-- С использованием специального оператора соединения JOIN:
Select Customers.cnum, Customers.cname, Salespeople.sname, Salespeople.city
from Customers join Salespeople
on Salespeople.snum = Customers.snum;

/* Составьте запрос, который показывает все пары покупатель – продавец (необязательно прикрепленный к данному покупателю), 
которые находятся в одном и том же городе. Не учитывайте покупателей с NULL-рейтингом. Выведите для каждой такой пары номер, фамилию, 
рейтинг и город покупателя, номер, фамилию и город прикрепленного продавца. Используйте алиасы для именования таблиц. 
Предложите два варианта такого запроса: без использования и с использованием специального оператора соединения JOIN.

Без использования специального оператора соединения JOIN: */
Select C.snum, C.cname, C.rating, C.city, S.snum, S.sname, S.city
from Customers C, Salespeople S
Where C.snum = S.snum and rating is not null and C.city = S.city
-- С использованием специального оператора соединения JOIN:
Select C.snum, C.cname, C.rating, C.city, S.snum, S.sname, S.city
from Customers C join Salespeople S
on C.snum = S.snum and C.city = S.city
Where rating is not null

/* Составьте запрос, который рассчитывает комиссионные продавца от суммы каждого заказа покупателей из Лондона или Рима. 
Выведите номер и сумму заказа, номер и город покупателя, сделавшего покупку, фамилию продавца, обслужившего покупателя, 
и рассчитанную сумму комиссионных продавца для данного заказа. Используйте алиасы для именования таблиц. 
Предложите два варианта такого запроса: без использования и с использованием специального оператора соединения JOIN.

Без использования специального оператора соединения JOIN: */
Select O.onum, O.amt, O.cnum, C.city, S.sname, S.comm*O.amt AS CommFromSumm
from Salespeople S, Orders O, Customers C
Where O.snum = S.snum and O.cnum = C.cnum and C.city = 'Rome' or O.snum = S.snum and O.cnum = C.cnum and C.city = 'London'
-- С использованием специального оператора соединения JOIN:
Select O.onum, O.amt, O.cnum, C.city, S.sname, S.comm*O.amt AS CommFromSumm
from Customers C join Orders O on O.cnum = C.cnum join Salespeople S on O.snum = S.snum 
Where C.city = 'Rome' or C.city = 'London'

/* Составьте запрос, который выводит все пары продавцов (номера и фамилии и город), живущих в одном городе. 
Исключите комбинации продавца с самим собой, а также строки, в которых значения повторяются в обратном порядке. 
Предложите два варианта такого запроса: без использования и с использованием специального оператора соединения JOIN.

Без использования специального оператора соединения JOIN: */
Select SA.snum as SalesA, SA.sname, SA.city, SB.snum as SalesB, SB.sname, SB.city
from Salespeople SA, Salespeople SB
where (SA.city = SB.city) and (SA.sname != SB.sname) and (SA.sname < SB.sname)
-- С использованием специального оператора соединения JOIN:
Select SA.snum as SalesA, SA.sname, SA.city, SB.snum as SalesB, SB.sname, SB.city
from Salespeople SA join Salespeople SB on SA.city = SB.city
where (SA.sname != SB.sname) and (SA.sname < SB.sname)

/* Составьте запрос, который выводит номер, сумму и дату каждого заказа за 3 октября 2000 года вместе с номером, 
фамилией и городом покупателя, сделавшего этот заказ. В результат запроса включите информацию и о тех покупателях, 
которые не осуществляли заказов в этот день (в этом случае вывести NULL-значения в информации о заказе). 
Используйте алиасы для именования таблиц. */
select O.onum, O.amt, O.odate, C.cnum, C.cname, C.city
from Orders o left outer join Customers c
on O.cnum = C.cnum and o.odate = '03/10/2000' -- Формат даты может отличаться в ЛК