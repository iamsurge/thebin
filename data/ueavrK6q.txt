#include <stdio.h>
#include <math.h>
#include <locale.h>

#define MAX_ITER 100000

void main() {
    setlocale(LC_ALL, "rus");
    double x,   // аргумент функции
        fx,  // значение функции
        Sn,  // слагаемое с номером n
        S,   // сумма ряда
        eps, // погрешность разложения в ряд
        n;   // номер слагаемого

 // Ввод аргумента функции и погрешности разложения
    printf("x = ");
    scanf_s("%lf", &x);
    printf("eps = ");
    scanf_s("%lf", &eps);

    // Вычисление функции в точке x
    fx = cos(x);

    // Вычисление слагаемого с номером 0
    n = 1;
    Sn = 1;
    S = Sn;

    // Пока 
    //     значение функции fx отличается от суммы ряда S более, чем на eps, 
    //     И номер слагаемого не слишком велик 
    // повторять
    while (fabs(fx - S) > eps && n < MAX_ITER) {
        // Вычислить очередное слагаемое домножением предыдущего
        Sn *= ((-1) * (x * x) / (2 * n - 1) * (2 * n));
        // Добавить слагаемое к сумме
        S += Sn;

        // Нарастить номер слагаемого
        n += 1;
    }

    // Предупреждение при достижении максимально допустимого количества итераций
    if (n == MAX_ITER)
        printf("Достигнуто максимальное количество итераций:\n", fx);

    // Вывести значение функции, суммы и количество слагаемых
    printf("fx=%12.10lf\n", fx);
    printf(" S=%12.10lf\n", S);
    printf(" n=%1.0lf\n", n);
}
