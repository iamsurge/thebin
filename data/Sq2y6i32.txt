IfNotExist, %A_ScriptDir%\ConfigKey2.ini
{
IniWrite, 3, %A_ScriptDir%\ConfigKey2.ini, KeyBind, soul ;IniWrite, Value, Filename, Section, Key
IniWrite, 6, %A_ScriptDir%\ConfigKey2.ini, KeyBind, botle
IniWrite, numpad3, %A_ScriptDir%\ConfigKey2.ini, KeyBind, rearm
IniWrite, $numpad3, %A_ScriptDir%\ConfigKey2.ini, KeyBind, COMBO
soul:=3
botle:=6
rearm:=numpad3
COMBO:=$numpad3
}
Else
{
IniRead, soul, %A_ScriptDir%\ConfigKey2.ini, KeyBind, soul ;IniRead, OutputVar, Filename, Section, Key [, Default]
IniRead, botle, %A_ScriptDir%\ConfigKey2.ini, KeyBind, botle
IniRead, rearm, %A_ScriptDir%\ConfigKey2.ini, KeyBind, rearm
IniRead, COMBO, %A_ScriptDir%\ConfigKey2.ini, KeyBind, COMBO
}

Gui, -ToolWindow
Gui, Add, Text, x12 y9 w120 h20 , Rearm
Gui, Add, Edit, x132 y9 w120 h20 vrearm, %rearm%

Gui, Add, Text, x12 y39 w120 h20 , Soul ring
Gui, Add, Edit, x132 y39 w120 h20 vsoul, %soul%

Gui, Add, Text, x12 y69 w120 h20 , Botle
Gui, Add, Edit, x132 y69 w120 h20 vbotle, %botle%

Gui, Add, Text, x12 y99 w120 h20 , COMBO
Gui, Add, Edit, x132 y99 w120 h20 vCOMBO, %COMBO%

Gui, Add, Button, x12 y139 w236 h50 , APPLY
Gui, Show, xCenter yCenter h212 w268, Soul+Botle+Rearm

Hotkey, %COMBO%, MyCombo ;Hotkey, KeyName [, Label, Options]
Return

MyCombo:
send {%soul%}
sleep 60
send {%botle%}
sleep 60
send {%rearm%}
Return

ButtonAPPLY:
Gui, submit, NoHide
IniWrite, %rearm%, %A_ScriptDir%\ConfigKey2.ini, KeyBind, rearm
IniWrite, %soul%, %A_ScriptDir%\ConfigKey2.ini, KeyBind, soul
IniWrite, %botle%, %A_ScriptDir%\ConfigKey2.ini, KeyBind, botle
IniWrite, %COMBO%, %A_ScriptDir%\ConfigKey2.ini, KeyBind, COMBO


Hotkey, %COMBO%, MyCombo
MsgBox,0, Success , Your settings have been successfully applied, 3
Reload
Return

GuiClose:
ExitApp
GuiEscape:
ExitApp